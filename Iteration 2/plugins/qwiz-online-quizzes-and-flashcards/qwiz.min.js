window.console||(window.console={log:function(){}}),qwiz_={};var qwizf=function(){var qname="qwiz_",debug=[];debug.push(!1),debug.push(!1),debug.push(!1),debug.push(!1),debug.push(!1),debug.push(!1),debug.push(!1),debug.push(!1),debug.push(!1),debug.push(!1),debug.push(!1),debug.push(!1),debug.push(!1);var $=jQuery;this.no_intro_b=[],this.qwizard_b=!1,this.processing_complete_b=!1,this.qrecord_b=!1,this.dataset_b=!1,this.preview=!1,this.any_pay_quiz_f=!1;var q=this,qqc,content,default_use_dict,default_use_terms,hint_timeout_sec,default_hangman_max_hints,post_id,correct,incorrect,errmsgs=[],n_qwizzes=0,qwizzled_b,qwizcards_page_f=!1,qwizdata=[],header_html,drag_and_drop_initialized_b=!1,try_again_obj="",$label_clicked=[],$prev_label_clicked=[],ignore_label_click_b=!1,next_button_active_b=!1,textentry_b=!1,loaded_metaphone_js_b=!1,default_textentry_terms_metaphones,current_question_textentry_terms_metaphones={},textentry_answers={},textentry_answer_metaphones={},textentry_matches={},lc_textentry_matches={},textentry_i_qwiz,suppress_hangman_hint_b=!1,Tcheck_answer_message,show_hint_timeout={},panel_exit_mobile_open_b=!1,panel_exit_mobile_just_closed_b,non_mobile_scrollLeft,non_mobile_scrollTop,qw,set_qwizard_data_b=!1,preview_mode="questions_active";function process_html(){$('p:contains("[!]"), :header:contains("[!]")').each(function(){0==$(this).html().search(/\s*(<.+?>)*\s*\[!+\][^]*?\[\/!+\]\s*(<.+?>)*\s*$/m)&&$(this).remove()}),$('p:contains("qwiz"), :header:contains("qwiz")').each(function(){var e=$(this).html();0==e.search(/\s*\[\/{0,1}qwiz[^\]]*\]\s*/m)&&$(this).replaceWith(e)});var e="",t=$("div.qwiz_wrapper"),i=$("div.qwiz_wrapper_fallback");if(t.length)e="div.qwiz_wrapper",q.wordpress_page_f=1==qqc.get_qwiz_param("wppf",""),i.css({display:"none"});else{if(0==i.length){$("head").append('<style type="text/css">\n.qwiz_wrapper_fallback_visible {\nvisibility: visible;\n}\n</style>\n')}e=content}n_qwizzes=0;var a=0;$(e).each(function(){var e=$(this).html();if(e){if(-1!=e.indexOf("[qwiz")){var i=q.process_html2(e,a);if(e=i.htm,q.qwizdemos)for(var s=q.qwizdemos.length,n=0;n<s;n++){var _=q.qwizdemos[n],r=_.length;_=_.substring(10,r-11),e=e.replace("<qwizdemo></qwizdemo>",_)}if(i.replace_body){debug[0]&&console.log("[process_html] document_qwiz_user_logged_in_b:",document_qwiz_user_logged_in_b);var o='<div id="preview_header"><h2 style="margin-bottom: 10px;">Preview quiz</h2><a href="javascript: void (0)" style="float: right; margin-right: 50px;" onclick="'+qname+".reset_preview ("+a+')">Reload preview</a><label><input type="radio" name="preview_radio" value="questions_active"          onclick="'+qname+".change_preview_mode (this, "+a+')" checked /> Questions active</label>&emsp;<label><input type="radio" name="preview_radio" value="show_answers"              onclick="'+qname+".change_preview_mode (this, "+a+')" /> Show answers</label>&emsp;<label><input type="radio" name="preview_radio" value="show_answers_and_feedback" onclick="'+qname+".change_preview_mode (this, "+a+')" /> Show answers and feedback</label>&emsp;</div>';$("body").html(o+e),$("div#qwiz"+a).css({margin:"auto"})}else $(this).html(e);if(a!=i.i_qwiz){a=i.i_qwiz,$(this).find("div.qwiz").on("mouseenter",function(e){if("div"==e.target.tagName.toLowerCase()&&"qwiz"==e.target.className)document_active_qwiz_qdeck=e.target;else{var t=$(e.target).parents("div.qwiz");t.length&&(document_active_qwiz_qdeck=t[0])}debug[7]&&(console.log("[qwiz mouseenter] e.target:",e.target),console.log("[qwiz mouseenter] document_active_qwiz_qdeck:",document_active_qwiz_qdeck))});var d=a-1;if(qwizdata[d])for(var c=qwizdata[d].n_questions,l=0;l<c;l++)if(qwizdata[d].bg_img[l]){var w=qwizdata[d].bg_img[l],u=new Image;u.src=w.src,u.i_qwiz=d,u.i_question=l,u.onload=function(){var e,t=this.width,i=this.height,a=$("#qwiz"+u.i_qwiz+"-q"+u.i_question);debug[0]&&console.log("[process_html] w:",t,", h:",i,", $qwizq:",a),e=w.height?w.height:w.width?Math.floor(w.width/t*i):i,e+="px",w.top&&(e="calc("+w.top+"px + "+e+")"),a.css({"min-height":e})}}}}t.length&&$(this).contents().unwrap()}else;}),n_qwizzes=a,$("div.qwiz_wrapper").removeClass("qwiz_shortcodes_hidden"),$("div.hangman_label").each(function(){var e=$(this),t=e.outerWidth();e.outerWidth(1.2*t)});for(a=0;a<n_qwizzes;a++)if(qwizdata[a].qrecord_id){var s={qwiz_qdeck:"qwiz",n_questions_cards:qwizdata[a].n_questions};qqc.jjax(qname,a,qwizdata[a].qrecord_id,"check_registered",s)}if(n_qwizzes&&qqc.init_enter_intercept(),q.qrecord_b&&qqc.set_user_menus_and_icons(),textentry_b)if("body"==content&&"undefined"!=typeof qcard_){var n=0,_=function(){var e=!1;debug[6]&&console.log("[run_init_textentry_autocomplete]",n),(qcard_.processing_complete_b||n>30)&&(debug[6]&&console.log("[run_init_textentry_autocomplete] OK"),q.init_textentry_autocomplete($("body")),e=!0),e||(setTimeout(_,100),n++)};_()}else q.init_textentry_autocomplete($("body"));q.processing_complete_b=!0}function dialog_no_credit_html(){return htm=[],htm.push('<div id="qwiz_dialog_no_credit" title="Are you taking the right quiz?">'),htm.push('<p style="margin-bottom: 1em;">'),htm.push("Note: this quiz has not been assigned as work you need to do."),htm.push("We&rsquo;ll record your work, but it may not count for your class."),htm.push("</p>"),htm.push("<p>"),htm.push("Please check with your teacher whether they assigned this quiz to your class."),htm.push("</p>"),htm.join("\n")}function init_preview_show_answers(e){$("div#qwiz"+e+' input[type="radio"][data-q="1"]').each(function(){var e=this.id.substr(6);q.process_choice(void 0,e)}),$("div#qwiz"+e+" button.show_the_answer").each(function(){$(this).trigger("click")}),$("div#qwiz"+e+" div.show_answer_got_it_or_not").hide(),$("div#qwiz"+e).find("input.qwiz_textentry, input.qwiz_single_char_entry").each(function(){var t=this.id.split("-")[2].substr(1),i=qwizdata[e].textentry[t].first_correct_answer;$(this).val(i),$(this).parents("div.qwizq").find("button.textentry_check_answer, button.qwiz_textentry_hint").hide(),"show_answers_and_feedback"==preview_mode&&$(this).parents("div.qwizq").find("div.qwiz-feedback").first().show()}),$("div#qwiz"+e).find("span.qwiz_hangman").each(function(){var t=$(this);preview_replace_hangman_entries(t,e,"final"),t.find("span.hangman_type_letters").hide(),"show_answers_and_feedback"==preview_mode&&t.parents("div.qwizq").find(".qwiz-feedback").show()}),$("div#qwiz"+e).find("div.qwizzled_label").each(function(){var e=$(this),t=e.attr("class").match(/qtarget_assoc(\d+)/)[1];place_label($(".qwizzled_target-"+t),e)})}function init_preview_questions_active(e){for(var t in $("div#qwiz"+e+' input[type="radio"]').attr("disabled",!1).prop("checked",!1),$("div#qwiz"+e).find("input.qwiz_textentry, input.qwiz_single_char_entry").attr("disabled",!1).val(""),$("div#qwiz"+e).find("button.textentry_check_answer, button.qwiz_textentry_hint").css({display:""}),$("div#qwiz"+e).find("span.qwiz_hangman").each(function(){preview_replace_hangman_entries($(this),e,"initial")}),qwizdata[e].$qwizzled)$("div#"+t).replaceWith(qwizdata[e].$qwizzled[t]),$("div#"+t).addClass("qwizq_preview").show(),qwizdata[e].$qwizzled[t]=$("div#"+t).clone(!0)}function preview_replace_hangman_entries(e,t,i){var a=e.parents("div.qwizq")[0].id.split("-")[1].substr(1),s=e.attr("class").match(/qwiz_hangman_c(\d+)/)[1],n=qwizdata[t].hangman[a].hangman_final_entry[s];if("initial"==i){var _=n.replace(/>[a-z0-9]</gi,">&ensp;<");e.find("span.hangman_current_entry").html(_)}else e.find("span.hangman_current_entry").html(n)}function place_labels(e,t,i){for(var a in debug[0]&&console.log("[place_labels] i_qwiz:",e,", i_question:",t,", qwizq_id:, ",i),qwizdata[e].correct_on_try1[t])if(1==qwizdata[e].correct_on_try1[t][a]){var s=$("div#"+i+" div#"+a);0==s.length&&(s=$("div#"+i+" span#"+a).first());var n,_=s.attr("class").match(/qwizzled_target-([0-9]+)/);_&&(n=_[1]),debug[8]&&console.log("[place_labels] $target:",s,", assoc_id:",n);var r=$("td.qwizzled_labels div.qtarget_assoc"+n);r.length||(r=$("div#"+i).find('td.qwizzled_labels div.qwizzled_label[data-label_target_id="'+n+'"]')),place_label(s,r),qwizdata[e].n_labels_correct++,qwizdata[e].n_label_attempts++}else qwizdata[e].correct_on_try1[t][a]=0;display_qwizzled_progress(e)}function place_label(e,t){var i=t.clone(!1);q.qwizard_b&&($editable=i.find(".qwiz_editable"),$editable.removeAttr("id").removeAttr("contenteditable").removeClass("qwiz_editable").addClass("qwizzled_label_placed"),debug[12]&&console.log("[place_label] $editable:",$editable)),i.appendTo(e),i.css({position:"absolute",left:"4px",top:"50%",height:"auto",width:"100%",transform:"translateY(-50%)"}),i.removeClass("qwizzled_label_unplaced"),i.find(".qwizzled_highlight_label").css("cursor","default").removeClass("label_click_highlight"),t.css({left:"0px",top:"0px"});var a=!1;if(r=t.attr("class").match(/qwizzled_n_targets([0-9]*)/)){a=!0;var s=r[0],n=parseInt(r[1],10);if(2==n)t.removeClass(s);else{var _="qwizzled_n_targets"+--n;t.removeClass(s).addClass(_)}}if(!q.qwizard_b&&!a){if(debug[8]&&console.log("[place_label] (draggable disable) $label[0]:",t[0]),t.css({color:"lightgray",left:"0px",top:"0px"}),t.find("*").css({color:"lightgray"}),t.find(".qwizzled_highlight_label").css("cursor","default"),t.removeClass("qwizzled_label_unplaced"),!q.qwizard_b)try{t.draggable("disable")}catch(e){}t.off("click")}if(!q.qwizard_b)if("div"==e[0].tagName.toLowerCase())e.droppable("instance")&&e.droppable("disable");else{var r=e.attr("class").match(/qtarget_sib-[0-9]+/);if(r){var o=e.parents("qwizq").find("span."+r[0]);o.droppable("instance")&&o.droppable("disable")}else{e.siblings("span").andSelf().droppable("disable")}}}function create_qwiz_divs(e,t,i,a){var s=t.match(/\[qwiz([^\]]*)\]/m),n=s[1];debug[0]&&console.log("[create_qwiz_divs] attributes: ",n);var _=-1!=(n=qqc.replace_smart_quotes(n)).search(/[\s;"]width/m),r=get_attr(n,"repeat_incorrect");qwizdata[e].repeat_incorrect_b="false"!=r,debug[0]&&console.log("[create_qwiz_divs] repeat_incorrect_value:",r,", repeat_incorrect_b:",qwizdata[e].repeat_incorrect_b);var o=get_attr(n,"random");qwizdata[e].random_b="true"==o,debug[0]&&console.log("[create_qwiz_divs] random:",o,", random_b:",qwizdata[e].random_b);var d=[];if(_){var c=n.replace(/(style\s*=\s*"[^"]*)/,"$1; position: absolute;");c=c.replace(/;\s*;/g,";"),d.push('<div id="xqwiz'+e+'" class="xqwiz" '+c+"></div>\n")}if(qwizdata[e].align){var l=qwizdata[e].align,w="";if("center"==l)w="margin: auto;";else if("right"==l)w="margin-left: auto;";else if("tiled"==l&&(w="float: left;",qwizdata[e].spacing)){var u=qwizdata[e].spacing+"px";w+=" margin-left: "+u+"; margin-bottom: "+u+";"}(s=n.match(/style\s*=\s*"[^"]*/m))?n=(n=n.replace(/(style\s*=\s*"[^"]*)/m,"$1; "+w)).replace(/;\s*;/g,";"):n+=' style="'+w+'"',n=n.replace(/align\s*=\s*"[^"]*"/,""),debug[0]&&console.log("[create_qwiz_divs] attributes: ",n)}d.push('<div id="qwiz'+e+'" class="qwiz visibilityhidden" '+n+">"),d.push('<div id="overlay-exit-mobile-qwiz'+e+'" class="overlay-exit-mobile-qwiz" onclick="'+qname+'.close_panel_exit_mobile(this)">'),d.push('<div id="panel-exit-mobile-qwiz'+e+'" class="panel-exit-mobile-qwiz">'),d.push('<button onclick="'+qname+".exit_mobile ("+e+')">'),d.push("Back to page view"),d.push("</button>"),d.push("<br />"),d.push("<span>"),d.push("(To return to this full-screen view, tap "),d.push('<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAk0lEQVR4nI3QMQ6EIBAF0BG2YLiGtjRcgt7EcBfDhShtbLwBHIgCJrPFbrGJqPvrl/k/MzAzPOUFAMYYRCSiaZpijGckAAARSynM3BVf1FpTSkkpQwiXaBzHnLNzbtu2Lhr+GS4exSUyxqzrCgDLssDnBefM87zv+3EcRHS3yVpba0XElFK/znsvhNBal1LuLv3mDbu1OYLB67+mAAAAAElFTkSuQmCC" />'),d.push(")"),d.push("</span>"),d.push('<div class="panel-icon-exit-mobile-qwiz"></div>'),d.push("</div>"),d.push("</div>"),d.push('<div id="icon-exit-mobile-qwiz'+e+'" class="icon-exit-mobile-qwiz" onclick="'+qname+".open_panel_exit_mobile ("+e+')"></div>');w="";""!=header_html&&"NA"!=header_html&&-1==header_html.indexOf("Enter header text")||(w=' style="display: none;"'),d.push('<div class="header-qwiz'+e+' qwiz-header qwiz_editable"'+w+">"),d.push(header_html),d.push("</div>"),d=d.join("\n");var z=[];z.push('<div class="qwiz-progress-container qwiz'+e+'">'),z.push('<div class="go-mobile-qwiz go-mobile-qwiz'+e+'" onclick="'+qname+".go_mobile ("+e+')" title="Full-screen view">'),z.push("</div>"),z.push('<img src="data:image/png;base64,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" class="go-mobile-qwiz go-mobile-qwiz'+e+'" />'),z.push('<div class="exit-mobile-qwiz exit-mobile-qwiz'+e+'" onclick="'+qname+".exit_mobile ("+e+')" title="Exit full-screen view">'),z.push("</div>"),z.push('<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAAAoVJREFUSA2lVj2PEkEY3plZV5I9Q3KBqzFHQkFJaCx0sTCxo6EnsfMPWPjBctqoueqMNf/CwtODxo7ySCxMaAjhgiRGiXjsh8+zzl5WKoZ7k+GdnZ33ed6PeWdRtVrtxnQ6jWxbvrUs8SCO449cq1Qqst1uWxBVr9fFaDSKW62WouaikTiO0xVCxBy2bXdpXC6Xb5ZKpZzv+xKkIp/PH3JuBMzN9FyD/4Fea5IjvmMk1FLKExAfc24sMH6tCQgeYgSa5BXB4MAz/ewbg6cG8M4niAZPotDPZ1ozdZ10v5GuVqsODTIkJGIkkQZn6q5qYwSOzbJYLEYsaBAEvlLqpQYQWq+h07leMlPS87wI4IIFhX4B8zMNGkAnRTaD/H+37Pf7PO+Xw+FwzYLidQPjUm9jBCSiRP+U4S+bJ44twaOoc570w+YcNUIjmkuSXzbRcrl8DPOfGOzUbEPR8z0QfFitVp8xNxNGsG2Hpo1nxmC4e1sSOo0DZO90BHO53H2cuIfw7RfGZjqJeWt/331/cfHjG+bmwoJvHoLss1LyHS9Ipl+ZwyeX3x0AeLD9re15EEIM9KrqhGH4BIQSV7vMhqf3bqVSOxu702bkldNH6o5Yp16v57CJd42ggQjuAZCec5CIchvpsyeTyWmhUFCLxcK6LgHTklyW0OwfAeK74JDz+fzUdd2UGK8MBACdTFGvrnSs8apPvyddQl4nAg8FfR5F0SOmhZ4DL4kCOsRzA9fPHkmMBXjHOIonNEwbD2tdHRWjSL4hIHhjDM4OPTjIH8JDwTn/GPB7QiCQpF9GfqB8ru2SInV+/vX7YDCwx+OxaDabAU8LCzqbzT7BaxcRfEEvPGV0fwEIA/zW345reQAAAABJRU5ErkJggg==" class="exit-mobile-qwiz exit-mobile-qwiz'+e+'" />');var h=qwizdata[e].n_questions;if((h>1||qwizdata[e].use_dataset||qwizdata[e].use_dataset_questions_htm)&&(!q.preview||q.preview_i_qwiz_plus1)){w="";qwizdata[e].hide_forward_back_b&&(w=' style="visibility: hidden;"'),f=qwizdata[e].use_dataset&&qwizdata[e].dataset_intro_f?"Go to &ldquo;Choose questions&rdquo;":"Go to first question",z.push('<span class="bbfe-wrapper bbfe-wrapper'+e+'">'),z.push('<span class="bbfe bbfe-qwiz'+e+" bck-question-qwiz"+e+'"'+w+' onclick="'+qname+".bck_question ("+e+', true )" title="'+f+'">'),z.push('<span class="bar-up">|</span>&#x25c0;&#xFE0E;'),z.push("</span>"),z.push('<span class="bbfe bbfe-qwiz'+e+" bck-question-qwiz"+e+'"'+w+' onclick="'+qname+".bck_question ("+e+', false)" title="Go to previous question">'),z.push("&#x25c0;&#xFE0E;"),z.push("</span>"),z.push('<span class="question-number-qwiz question-number-qwiz'+e+'"'+w+">"),z.push("</span>"),z.push('<span class="bbfe bbfe-qwiz'+e+" fwd-question-qwiz"+e+'"'+w+' onclick="'+qname+".fwd_question ("+e+', false)" title="Go to next question">'),z.push("&#x25b6;&#xFE0E;"),z.push("</span>"),z.push('<span class="bbfe bbfe-qwiz'+e+" fwd-question-qwiz"+e+'"'+w+' onclick="'+qname+".fwd_question ("+e+', true )" title="Go to most-recent question">'),z.push('&#x25b6;&#xFE0E;<span class="bar-up">|</span>'),z.push("</span>"),z.push("</span>")}if(qwizdata[e].qrecord_id){z.push('<span class="response_recorded_wrapper response_recorded_wrapper-qwiz'+e+'">'),z.push('<span class="response_recorded response_recorded-qwiz'+e+'">'),z.push("&#x2714;&#xFE0E;"),z.push("</span>"),z.push('<span class="response_recorded response_recorded_shadow response_recorded_shadow-qwiz'+e+'">'),z.push("&#x2714;&#xFE0E;"),z.push("</span>"),z.push("</span>");var m=qqc.get_qwiz_param("url","./");z.push('<div class="qwiz_icon_and_menu_container  lock_unlock qwiz'+e+'">'),z.push('<div id="locked-qwiz'+e+'" class="qwiz-locked qwiz_menu_icon">'),z.push('<img src="'+m+'/images/icon_locked.png" />'),z.push("</div>"),z.push('<div id="unlocked-qwiz'+e+'" class="qwiz-unlocked qwiz_menu_icon">'),z.push('<img src="'+m+'/images/icon_unlocked.png" />'),z.push("</div>"),z.push('<div class="qwiz_icon_trigger_and_menu qwiz-hover">'),z.push('<div class="qwiz_icon_trigger">'),z.push("</div>"),z.push('<div id="pay_unlock_menu-qwiz'+e+'" class="qwiz-pay_unlock_menu qwiz_menu">'),z.push("</div>"),z.push("</div>"),z.push("</div>");var p="";(q.no_intro_b[e]||1==h)&&(p=" qwiz-usermenu_icon_no_intro"),z.push('<div class="qwiz_icon_and_menu_container qwiz'+e+'">'),z.push('<div class="qwiz-usermenu_icon qwiz_menu_icon'+p+'">'),z.push("&#x25bc;"),z.push("</div>"),z.push('<div class="qwiz_icon_trigger_and_menu qwiz-hover">'),z.push('<div class="qwiz_icon_trigger" style="left: -12px; top: -4px;">'),z.push("</div>"),z.push('<div id="usermenu-qwiz'+e+'" class="qwiz-usermenu qwiz_menu">'),z.push("</div>"),z.push("</div>"),z.push("</div>")}w="",qwizdata[e].hide_progress_b&&(w=' style="display: none;"'),z.push('<div id="progress-qwiz'+e+'" class="qwiz-progress"'+w+">"),z.push("</div>"),z.push('<div style="clear: both;"></div>'),z.push("</div>"),z=z.join("\n");var g="";(qwizdata[e].qrecord_id||qwizdata[e].use_dataset)&&(g='<div id="qwiz_login-qwiz'+e+'" class="qwiz-login">\n</div>');var b=[];if(h>1||qwizdata[e].use_dataset||qwizdata[e].use_dataset_questions_htm||q.qwizard_b?(a&&-1!=a.indexOf("[unpaid")&&-1!=a.indexOf("[/unpaid]")?a=(a=a.replace("[unpaid]",'<span class="unpaid_msg">')).replace("[/unpaid]","</span>"):a+='<span class="unpaid_msg_payment_type unpaid_msg"></span>',qwizdata[e].use_dataset&&!q.preview&&-1==a.indexOf("[restart")&&(a+="<br />[restart]"),a&&(a=create_restart_button(e,a)),q.qwizard_b&&(a=qqc.shortcodes_to_video_elements(a)),qwizdata[e].summary_b&&b.push(create_summary_report_div(e,a))):(1==h&&a&&(a=create_restart_button(e,a),b.push('<div class="single-question_exit">'),b.push(a),b.push("</div>")),qwizdata[e].qwizzled_b||qwizdata[e].qrecord_id||qqc.is_mobile()||q.qwizard_b||(z="")),b.push('<div class="next_button" id="next_button-qwiz'+e+'">\n'),b.push('<button class="qwiz_button" onclick="'+qname+".next_question ("+e+')">'),b.push('<span id="next_button_text-qwiz'+e+'">'),b.push(T("Start quiz")),b.push("</span>"),b.push("</button>\n"),b.push("</div>\n"),qwizdata[e].summary_b||h>1&&a&&b.push(create_summary_report_div(e,a)),w="",qqc.get_qwiz_param("beta")&&(w='style = "background: red;"'),!qwizdata[e].hide_qwizcards_icon_b){b.push('<div class="icon_qwiz" id="icon_qwiz'+e+'" '+w+">");var v=qqc.get_qwiz_param("icon_qwiz");if("Not displayed"!=v){"Icon only"!=v&&b.push('<a href="mailto:support@qwizcards.com" style="border: none; box-shadow: none;">');var f="Questions, comments, suggestions? support@qwizcards.com";b.push('<img class="icon_qwiz" style="border: none;" title="'+f+'" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAUCAIAAAALACogAAAABnRSTlMA/wD/AP83WBt9AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABP0lEQVR4nGP8//8/AymAiSTV5GhgwSZ4rcRrxRooW3futlBnJDlGND/cXzXVccFLVP0oepiwqtZJyH2wrenBtogQBgYGhsv9q15j9cO1qTDVW8JEGRgYGBi0PJ0YGBgYrjzCpuH+qv1rGBgYGHQLoaoZGBgYlOTEGRgYGB68uY+h4fXuQy8ZGBgYnLSRvXjv0UsGBgYGBRFFdA1Prm+6x8DAwBBio4XsyO37GBgYGHTkEHaixYO4mszrWTl1CjmH7iMcKe5nhdAAi4cnL6/A3HbrHgMDw56pJ0QYIOHr5JgmgzASZoOFdggDAwPDy03HRCEhs6YJEne6c0uQHYkUcXt76pL3oTqQQbxqVjay8Sh+cC5pmuuEpkFMWQZNBCNpwMDrWTmT2+5hCCu54EqtomkVLjqYwgoiuGzACWifgQDhK2rq5bcX2gAAAABJRU5ErkJggg==" />'),"Icon only"!=v&&b.push("</a>")}}return b.push("</div>"),i=d+z+g+i+b.join("")+"</div>\n"}function create_summary_report_div(e,t){return bottom_html=[],bottom_html.push('<div id="summary-qwiz'+e+'" class="qwiz-summary">\n'),bottom_html.push('<div id="summary_report-qwiz'+e+'">'),bottom_html.push("</div>\n"),bottom_html.push('<div id="qwiz_exit-qwiz'+e+'" class="qwiz-exit qwiz_editable">'),bottom_html.push(t),bottom_html.push("</div>\n"),bottom_html.push('<button class="summary_exit_mobile_qwiz" onclick="'+qname+".exit_mobile ("+e+')">\n'),bottom_html.push("Return to page view"),bottom_html.push("</button>\n"),bottom_html.push("</div>\n"),bottom_html.join("")}function get_login_html(e,t,i,a){t=t?1:0,a=a?1:0;var s="onfocus=\"jQuery ('#qwiz_login-qwiz"+e+" p.login_error').hide ()\"",n="<p>";n+=i?"<strong>"+i+"</strong>":t?"<strong>"+T("Add team member")+"</strong>":"<strong>"+T("Record score/credit?")+"</strong>",n+="</p>",n+='<form action="nada" onSubmit="return qwiz_.login ('+e+", "+t+", "+a+')">\n<table border="0" align="center" width="100%"><tr><td><label for="qwiz_username-qwiz'+e+'">'+T("Login name")+'</label></td><td><input type="text" id="qwiz_username-qwiz'+e+'" '+s+' /></td></tr><tr><td><label for="qwiz_password-qwiz'+e+'">'+T("Password")+'</label></td><td><input type="password" id="qwiz_password-qwiz'+e+'" /></td></tr><tr><td style="text-align: right;"><span class="qwiz-remember" title="'+T("Save preference (do not use on shared computer)")+'"><label><span><input type="checkbox" /></span>&nbsp;'+T("Remember")+'</label></span></td><td><button type="submit" class="qwiz_button">'+T("Student login")+"</button>&ensp;",t||(n+='<span class="qwiz_button" onclick="qwiz_qcards_common.create_register_taker_screen (\''+qname+"', "+e+", "+a+')">'+T("New student - register")+"</span>&ensp;"),n+='<span class="qwiz_login_cancel_no_thanks qwiz_button" onclick="'+qname+".no_login ("+e+","+t+')">',n+=T(t?"Cancel":"No thanks"),n+="</span></td></tr>",t||(n+='<tr><td></td><td class="qwiz-smaller"><a href="'+qqc.get_qwiz_param("server_loc","http://qwizcards.com/admin")+'/password_reset_request" target="_blank">'+T("Forgot password?")+"</a></td></tr>");var _="new_account";return-1!=window.location.href.indexOf("sciencemusicvideos.com")&&(_="new_account_smv"),n+='<tr><td colspan="2"><hr style="margin: 5px;"></td></tr><tr><td colspan="2" class="qwiz-center"><b>Teachers: track your students&rsquo; progress on quizzes and flashcards.&nbsp; <a href="'+qqc.get_qwiz_param("secure_server_loc","https://qwizcards.com/admin")+"/"+_+'" target="_blank">Create&nbsp;teacher&nbsp;administrative&nbsp;account</a></b></td></tr></table>\n</form><p class="login_error">'+T("Login incorrect. Please try again")+"</p>\n"}function create_restart_button(e,t,i){var a=t.match(/\[restart[^\]]*\]/);if(a){var s;s=i||1==qwizdata[e].n_questions?T("Do this question again"):qwizdata[e].use_dataset&&qwizdata[e].dataset_intro_f?T("Practice more questions"):T("Take this quiz again");var n=get_attr(qqc.replace_smart_quotes(a[0]),"label");n&&(s=n);var _='<button class="qwiz_button qwiz_restart" onclick="'+qname+"."+(i?"redo_question":"restart_quiz")+" ("+e+')">'+s+"</button>";t=t.replace(a,_)}return t}function create_bg_img_style(e,t){var i="",a=qwizdata[e].bg_img[t];if(a){var s=a.top?a.top+"px":"0";i=' style="background: no-repeat '+(a.left?a.left+"px":"0")+" "+s+" / "+(a.width?a.width+"px":"auto")+" "+(a.height?a.height+"px":"auto")+" url("+a.src+')"';debug[0]&&console.log("[create_bg_img_style] style:",i)}return i}function process_question_attributes(e,t,i,a){set_qwizard_data_b&&(void 0===a&&(a=t),qw.questions_cards[a]={}),qwizdata[e].dataset_id[t]=t,qwizdata[e].unit[t]=qwizdata[e].default_unit;var s=i.match(/\[(<code><\/code>)*q\s*([^\]]*)\]/m)[2];if(s){s=qqc.replace_smart_quotes(s),set_qwizard_data_b&&(qw.questions_cards[a].question_attributes=s),q.qwizard_b&&(qwizdata[e].qwizard_multiple_choice_b[t]="true"==get_attr(s,"multiple_choice"));var n=get_attr(s,"topic",!0);if(n||(n=get_attr(s,"unit",!0)),n){debug[4]&&console.log("[process_question_attributes] question_topics: ",n),set_qwizard_data_b&&(qw.questions_cards[a].topic=n),n=n.split(/; */);for(var _=0;_<n.length;_++){n[_]=n[_].replace(/\s/g,"_");var r=n[_];-1==qwizdata[e].topics.indexOf(r)&&qwizdata[e].topics.push(r)}qwizdata[e].question_topics[t]=n}var o=get_attr(s,"dataset_id");o&&(qwizdata[e].dataset_id[t]=o);var d=get_attr(s,"unit");d&&(qwizdata[e].unit[t]=d,set_qwizard_data_b&&(qw.questions_cards[a].unit=d),-1==qwizdata[e].units.indexOf(d)&&qwizdata[e].units.push(d));var c=get_attr(s,"use_dataset_question");c&&(qwizdata[e].use_dataset_question_ids[t]=c,qwizdata[e].dataset_id[t]=c,set_qwizard_data_b&&(qw.questions_cards[a].from_dataset_b=!0));var l=get_attr(s,"bg_img_src");if(l){var w={};w.src=l,w.left=get_attr(s,"bg_img_left"),w.top=get_attr(s,"bg_img_top"),w.width=get_attr(s,"bg_img_width"),w.height=get_attr(s,"bg_img_height"),qwizdata[e].bg_img[t]=w,set_qwizard_data_b&&(qw.questions_cards[a].bg_img=w)}}return n}function check_questions_have_topics(e){for(var t=!1,i=0;i<qwizdata[e].n_questions;i++)qwizdata[e].information_question_b[i]||qwizdata[e].question_topics[i]||(qwizdata[e].question_topics[i]=["Other"],t=!0);t&&-1==qwizdata[e].topics.indexOf("Other")&&qwizdata[e].topics.push("Other"),debug[4]&&console.log("[check_questions_have_topics] qwizdata[i_qwiz].question_topics:",qwizdata[e].question_topics),qwizdata[e].topic_statistics={};for(var a=qwizdata[e].topics.length,s=0;s<a;s++){var n=qwizdata[e].topics[s];qwizdata[e].topic_statistics[n]={},qwizdata[e].topic_statistics[n].n_correct=0,qwizdata[e].topic_statistics[n].n_incorrect=0}}function hide_current_question(e,t){var i="qwiz"+e+"-q"+t;$("#"+i).hide(),document_qwiz_mobile&&$("#mobile_"+i).hide()}function reset_label_positions(e){debug[8]&&console.log("[reset_label_positions] $qwizq:",e),e.find("td.qwizzled_labels div.qwizzled_label").each(function(){var e=$(this).parents("li").offset();debug[8]&&console.log("[reset_label_positions] label_offset:",e),$(this).data("label_x",e.left).data("label_y",e.top)})}function process_multiple_choice(e,t,i,a){var s,n,_="",r=qqc.opening_tag_shortcode_pos("([c]|[c*])",i);if(r==i.length)errmsgs.push(T('Did not find choices ("[c]")')+".  qwiz: "+(e+1)+", "+T("question")+" "+(t+1)),s="",n="";else{var o,d=i.substr(0,r);if(debug[0]&&(console.log("[process_multiple_choice] span_pos: ",r),console.log("[process_multiple_choice] question_htm: ",d)),qwizdata[e].qrecord_id)qqc.isInteger(qwizdata[e].dataset_id[t])?(o=qqc.remove_tags_eols(d),qwizdata[e].q_and_a_text[t]=qqc.q_and_a_hash(o),qwizdata[e].q_and_a_crc32[t]=qwiz_crc32(i)):(qwizdata[e].q_and_a_text[t]=qwizdata[e].dataset_id[t],qwizdata[e].q_and_a_crc32[t]="dataset");set_qwizard_data_b&&(qw.questions_cards[t].type="multiple_choice",d=qqc.shortcodes_to_video_elements(d),qw.questions_cards[t].question_text=a+d),s='<div id="qwiz'+e+"-q"+t+'" class="qwizq"'+create_bg_img_style(e,t)+'>\n<div class="qwiz-question qwiz_editable">'+a+d+"</div>",debug[1]&&console.log("[process_multiple_choice] desktop_htm: ",s),n=i.substr(r),_="</p>"}var c=i.match(/\[c\*{0,1}\]/gm),l=0;c&&(l=c.length),debug[0]&&console.log("[process_multiple_choice] n_choices: ",l),set_qwizard_data_b&&(qw.questions_cards[t].n_choices=l,qw.questions_cards[t].choices=[],qw.questions_cards[t].feedbacks=[]);for(var w=0,u=["[c]","[c*]"],z=["[c]","[c*]","[x]"],h=!1,m=-1,p=[],g=[],b=[],v=-1,f=0;f<l;f++){var y=qqc.parse_html_block(n,u,z);if(n=n.substr(y.length),q.wordpress_page_f&&-1!=(y=cvt_feedback(y)).indexOf("[c*]")&&(c[f]="[c*]"),y=(C=process_feedback_item(y,e,t,f)).choice_html,C.feedback_div)if(f!=l-1||h||1==l){h=!0,C.fx_b&&(-1==m?m=p.length:errmsgs.push(T("Got more than one [fx]")+".  qwiz: "+(1+e)+", "+T("question")+" "+(1+t))),p.push(C.feedback_div),g.push(C.feedback_item_html),(C=process_feedback_item(y,e,t,k)).feedback_div&&errmsgs.push(T("More than one feedback shortcode [f] or [fx] given with a choice")+".  qwiz: "+(1+e)+", "+T("question")+" "+(1+t)+", "+T("choice")+" "+(1+f))}else{p[0]=C.feedback_div,g[0]=C.feedback_item_html;var x=1;C.fx_b&&(m=0,x=0);for(var k=1;k<l;k++){if(y=(C=process_feedback_item(y,e,t,k)).choice_html,!C.feedback_div)break;p[k]=C.feedback_div,g[k]=C.feedback_item_html,C.fx_b?-1==m?m=k:errmsgs.push(T("Got more than one [fx]")+".  qwiz: "+(e+1)+", "+T("question")+" "+(1+t)):x++}1==x||-1!=m?(p[l-1]=p[0],p[0]="",g[l-1]=g[0],g[0]="",0==m&&(m=l-1)):x!=l?errmsgs.push(T("Number of feedback items does not match number of choices")+".  qwiz: "+(1+e)+", "+T("question")+" "+(1+t)):p[0]=p[0].replace(/(qwiz[0-9]+-q[0-9]+-a)[0-9]+/,"$10")}else p.push(""),g.push("");debug[2]&&console.log("[process_multiple_choice] feedback_divs:",p);var $=y.match(/\[c\*{0,1}\]/m)[0],A=y.replace(/\[c\*{0,1}\]/m,"");if(b.push(A),y=/^\s*<([ph]|br)/.test(A)?A.replace(/^\s*<([ph]|br)[^>]*>/,"$&"+$):$+A,l>1||q.qwizard_b&&qwizdata[e].qwizard_multiple_choice_b[t]){var C;(C=create_radio_button_html(e,t,f,c[f])).correct&&(w++,v=f);var j='onclick="'+qname+".process_choice (event, '"+(Y=(F="qwiz"+e+"-q"+t)+"-a"+f)+"')\"";if(y=y.replace(/\[c\*{0,1}\]/m,C.htm+'<span class="qwiz-choice qwiz_editable" data-i_choice="'+f+'" '+j+">"),/^\s*<[ph]/.test(y)){var I=y.length;if("</p"!=y.substr(I-4,3)&&"</h"!=y.substr(I-5,3)){var O=y.indexOf(">");-1!=O&&(_+=y.substr(0,O+1),y=y.substr(O+1)),y+="</span>"}else y=y.replace(/<\/(p|h[1-6])>$/,"</span>$&")}else y+="</span>";if(set_qwizard_data_b){var E=y.match(/<span class="qwiz-choice[^>]+>/),S=(E=y.match(/<span class="qwiz-choice[^>]+>([^]*?)<\/span>/),qqc.shortcodes_to_video_elements(E[1]));qw.questions_cards[t].choices[f]=S}var R="";q.qwizard_b&&(R=' style="cursor: text;"'),_+='<span class="choices-'+F+" choice-"+Y+' qwiz-choices" '+j+' data-i_choice="'+f+'"'+R+'>\n<span class="qwiz-choice" data-i_choice="'+f+'">'+y+"</span></span>"}else{y=y.replace(/\[c\*{0,1}\]/m,""),v=0,w=1,j=1==qwizdata[e].n_questions?qname+".process_choice (event, 'qwiz"+e+"-q"+t+"-a0', true)":qname+".show_answer_got_it_or_not ("+e+", "+t+", this)";var W=y;-1!=W.indexOf("[show_me_placeholder]")&&(W="Show me the answer"),_+='<button class="qwiz_button show_the_answer qwiz-choice qwiz_editable" data-i_choice="0" style="margin-left: 20px;" onclick="'+j+'">',_+=W,_+="</button>\n",set_qwizard_data_b&&(qw.questions_cards[t].type="show_me",y=qqc.shortcodes_to_video_elements(y),qw.questions_cards[t].choices[f]=y),p[0]||errmsgs.push(T("Feedback [f] is required for a one-choice question")+".  qwiz: "+(1+e)+", "+T("question")+" "+(1+t))}}if(set_qwizard_data_b&&"show_me"!=qw.questions_cards[t].type){debug[12]&&console.log("[process_multiple_choice] choices_html:",_);var L=_.substr(31).indexOf("<span");-1!=L&&-1==_.substr(31+L).search(/<p|<h[1-6]|<br/)&&(qw.questions_cards[t].choices_inline=!0)}s+=_,s+='<div style="clear: both;"></div>\n',debug[1]&&console.log("[process_multiple_choice] desktop_htm: ",s),0==w?q.qwizard_b||qwizdata[e].use_dataset||qwizdata[e].use_dataset_question_ids[t]||errmsgs.push(T("No choice was marked correct")+".  qwiz: "+(1+e)+", "+T("question")+" "+(1+t)):w>1?errmsgs.push(T("More than one choice was marked correct")+".  qwiz: "+(1+e)+", "+T("question")+" "+(1+t)):set_qwizard_data_b&&(qw.questions_cards[t].correct_choice=v);for(f=0;f<l;f++)if(!p[f])if(-1!=m&&f!=v)p[f]=p[m].replace(/(qwiz[0-9]+-q[0-9]+-a)[0-9]+/,"$1"+f);else{var B=q.canned_feedback(f==v);p[f]=create_feedback_div_html(e,t,f,B),g[f]=B}if(s+=p=p.join("\n"),set_qwizard_data_b)for(f=0;f<l;f++)qw.questions_cards[t].feedbacks[f]=qqc.shortcodes_to_video_elements(g[f]);1==l&&(qwizdata[e].n_questions>1||qwizdata[e].use_dataset)&&(s+=create_got_it_or_not("",e,t)),debug[2]&&console.log("[process_multiple_choice] desktop_htm: ",s),s+="</div>\n";var F="mobile_qwiz"+e+"-q"+t,G=[];G.push('<div id="mobile_qwiz'+e+"-q"+t+'" class="qwizq-mobile">\n'),G.push(a+d),G.push('<ul class="mobile_choices">');for(f=0;f<l;f++){var Y=F+"-a"+f,Q=f==v?'data-q="1"':"";j=l>1||1==qwizdata[e].n_questions?qname+".process_choice (event, '"+Y+"')":qname+".show_answer_got_it_or_not ("+e+", "+t+", this)",G.push('<li id="choice-'+Y+'" class="mobile_choice" onclick="'+j+'" '+Q+">"),G.push('<div class="mobile_choice">'),G.push(b[f]),G.push("</div>"),G.push("</li>")}return G.push("</ul>"),G.push('<div style="clear: both;"></div>'),G.push(p.replace(/id="qwiz/gm,'id="mobile_qwiz')),G.push("</div>"),1==l&&(qwizdata[e].n_questions>1||qwizdata[e].use_dataset)&&G.push(create_got_it_or_not("mobile_",e,t)),s+"\n"+(G=G.join("\n"))}function process_textentry(e,t,i,a){qwizdata[e].textentry||(qwizdata[e].textentry={},textentry_b=!0);var s="",n=qqc.opening_tag_shortcode_pos("([c*]|[c])",i);if(n<i.length?s=i.substr(0,n):errmsgs.push(T("No answer-word given")+".  qwiz: "+(1+e)+", "+T("question")+" "+(1+t)),qwizdata[e].qrecord_id)if(qqc.isInteger(qwizdata[e].dataset_id[t])){var _=qqc.remove_tags_eols(s);_=_.replace(/\[textentry[^\]]*\]/,"_________"),qwizdata[e].q_and_a_text[t]=qqc.q_and_a_hash(qqc.remove_tags_eols(_)),qwizdata[e].q_and_a_crc32[t]=qwiz_crc32(i)}else qwizdata[e].q_and_a_text[t]=qwizdata[e].dataset_id[t],qwizdata[e].q_and_a_crc32[t]="dataset";set_qwizard_data_b&&(qw.questions_cards[t].type="textentry",s=qqc.shortcodes_to_video_elements(s),qw.questions_cards[t].question_text=a+s,qw.questions_cards[t].choices=[],qw.questions_cards[t].correct_choice_fs=[],qw.questions_cards[t].feedbacks=[]);var r=!1,o=!0,d=3,c="true"==default_use_dict,l="true"==default_use_terms,w=!1,u=i.match(/\[textentry([^\]]*)\]/m),z="";if(u&&(z=u[1])){r="true"==get_attr(z=qqc.replace_smart_quotes(z),"plural"),o="false"!=get_attr(z,"suggest");var h=get_attr(z,"minlength");""!=h&&(d=h);var m=get_attr(z,"use_terms");m&&(l="false"!=m);var p=get_attr(z,"use_dict");p&&(c="false"!=p),w="true"==get_attr(z,"single_char")}set_qwizard_data_b&&(qw.questions_cards[t].type=w?"one_letter_answer":"textentry",qw.questions_cards[t].textentry_attributes=z,qw.questions_cards[t].textentry_plural_b=r);var g,b,v=i.substr(n);i=i.substr(0,n),w?(g="qwiz_single_char_entry",b='style="width: 2rem; padding: 2px;" '):o?(g="qwiz_textentry",b='style="width: 18em; padding: 2px;" '):(g="qwiz_textentry_no_suggest",b='style="width: 18em; padding: 2px;" ');var f,y='<input type="text" id="textentry-qwiz'+e+"-q"+t+'" autocomplete="off" class="'+g+'" '+b+'onfocus="'+qname+'.set_textentry_i_qwiz (event, this)" />',x=new RegExp("\\[textentry[^\\]]*\\]");f=q.qwizard_b?create_hangman_textentry_editable_divs(e,t,a,[y],"textentry",x,i):'<div id="qwiz'+e+"-q"+t+'" class="qwizq">\n'+a+i.replace(x,y),f+='<br /><div id="textentry_check_answer_div-qwiz'+e+"-q"+t+'" class="textentry_check_answer_div">\n<button class="qwiz_button qwiz_button_disabled textentry_check_answer" onclick="'+qname+".textentry_check_answer ("+e+')">'+T("Check answer")+'</button>\n&emsp;\n<button class="qwiz_button qwiz_textentry_hint" style="display: none; font-size: 11px; padding: 2px 2px; border-radius: 5px;" onclick="'+qname+".textentry_hint ("+e+')" disabled>'+T("Hint")+"</button>\n</div>\n";var k=0,$=["[c]","[c*]"],A=["[c]","[c*]","[x]"],C=[];qwizdata[e].textentry[t]={},qwizdata[e].textentry[t].choices=[],qwizdata[e].textentry[t].textentry_plural_b=r,qwizdata[e].textentry[t].textentry_suggest_b=o,qwizdata[e].textentry[t].textentry_minlength=d,qwizdata[e].textentry[t].use_terms_b=l,qwizdata[e].textentry[t].use_dict_b=c,qwizdata[e].textentry[t].single_char_b=w,qwizdata[e].textentry[t].choices_correct=[],qwizdata[e].textentry[t].answers=[],qwizdata[e].textentry[t].first_correct_answer="",qwizdata[e].check_answer_disabled_b=!0;for(var j=0,I=!1;;){var O=qqc.parse_html_block(v,$,A);if("NA"==O)break;v=v.substr(O.length),q.wordpress_page_f&&(O=cvt_feedback(O)),O=(E=process_feedback_item(O,e,t,j)).choice_html;var E,S="";if(E.feedback_div)!0,C.push(E.feedback_div),S=E.feedback_item_html,(E=process_feedback_item(O,e,t,j)).feedback_div&&errmsgs.push(T("More than one feedback shortcode [f] given with choice")+".  qwiz: "+(1+e)+", "+T("question")+" "+(1+t)+", "+T("choice")+" "+(1+j));else C.push("");set_qwizard_data_b&&(qw.questions_cards[t].feedbacks[j]=qqc.shortcodes_to_video_elements(S));var R=-1!=O.search(/\[c\*\]/);R&&k++,O=O.replace(/[^]*\[c\*{0,1}\]/,""),q.qwizard_b&&-1!=O.indexOf("placeholder")||(O=O.replace(/<[^>]+>|\n|&nbsp;/g,"")),-1==O.replace(";","").search(/\S/)&&errmsgs.push(T("No word(s) given for [textentry] choice")+".  qwiz: "+(e+1)+", "+T("question")+" "+(1+t)+", "+T("choice")+" "+(1+j));for(var W=O.split(/\s*;\s*/),L=[],B=0;B<W.length;B++)-1!=W[B].search(/\S/)&&L.push(qqc.trim(W[B]));"*"==L[0]&&(I=!0,R&&errmsgs.push(T('For [textentry] question, wildcard choice ("*", for any other user entry) cannot be marked correct "[c*]"')+".  qwiz: "+(e+1)+", "+T("question")+" "+(1+t)+", "+T("choice")+" "+(1+j))),qwizdata[e].textentry[t].choices.push(L),qwizdata[e].textentry[t].choices_correct.push(R),set_qwizard_data_b&&(qw.questions_cards[t].choices.push(L.join(";")),qw.questions_cards[t].correct_choice_fs.push(R?1:0)),R&&L.length&&""==qwizdata[e].textentry[t].first_correct_answer&&(qwizdata[e].textentry[t].first_correct_answer=L[0]);var F=L.length;for(B=0;B<F;B++)-1!=qwizdata[e].textentry[t].answers.indexOf(L[B])&&"Enter word"!=L&&errmsgs.push(T("Answer given in more than one choice")+": "+L[B]+".  qwiz: "+(e+1)+", "+T("question")+" "+(1+t)+", "+T("choice")+" "+(1+j));qwizdata[e].textentry[t].answers=qwizdata[e].textentry[t].answers.concat(L),j++}set_qwizard_data_b&&(qw.questions_cards[t].n_choices=j),I||(j++,qwizdata[e].textentry[t].choices.push(["*"]),qwizdata[e].textentry[t].choices_correct.push(!1),set_qwizard_data_b&&(qw.questions_cards[t].choices.push("*"),qw.questions_cards[t].correct_choice_fs.push(0),qw.questions_cards[t].n_choices=j));var G=j;f+='<div style="clear: both;"></div>\n',0==k&&errmsgs.push(T("No choice was marked correct")+".  qwiz: "+(1+e)+", "+T("question")+" "+(1+t));for(j=0;j<G;j++)if(!C[j]){var Y=q.canned_feedback(qwizdata[e].textentry[t].choices_correct[j]);C[j]=create_feedback_div_html(e,t,j,Y),set_qwizard_data_b&&(qw.questions_cards[t].feedbacks[j]=Y)}return f+=C.join("\n"),f+="</div>\n",(debug[2]||debug[12])&&console.log("[process_textentry] new_htm: ",f),f}function process_hangman(e,t,i,a){var s=-1!=i.indexOf("hangman_img_wrapper"),n=qqc.opening_tag_shortcode_pos("([c*]|[c])",i);if(n<i.length?question_text=i.substr(0,n):(errmsgs.push(T("Did not get [c] or [c*] (hangman answer) with [hangman]")+".  qwiz: "+(1+e)+", "+T("question")+" "+(1+t)),n=0),qwizdata[e].qrecord_id)if(qqc.isInteger(qwizdata[e].dataset_id[t])){var _=qqc.remove_tags_eols(question_text);_=_.replace(/\[hangman[^\]]*\]/g,"_________"),qwizdata[e].q_and_a_text[t]=qqc.q_and_a_hash(qqc.remove_tags_eols(_)),qwizdata[e].q_and_a_crc32[t]=qwiz_crc32(i)}else qwizdata[e].q_and_a_text[t]=qwizdata[e].dataset_id[t],qwizdata[e].q_and_a_crc32[t]="dataset";var r=default_hangman_max_hints,o=!0,d="";if((u=i.match(/\[hangman([^\]]*)\]/m))&&(d=u[1])){var c=get_attr(d=qqc.replace_smart_quotes(d),"hints");c&&(-1==c.search(/[^0-9]/)?r=parseInt(c,10):errmsgs.push(T('"hints" for [hangman] should be a number')+".  qwiz: "+(1+e)+", "+T("question")+" "+(1+t))),o=!("false"==get_attr(d,"type_letters"))}var l="hangman",w=a;s&&(l="hangman_labeled_diagram",w=""),set_qwizard_data_b&&(qw.questions_cards[t].type=l,qw.questions_cards[t].hangman_attributes=d,question_text=qqc.shortcodes_to_video_elements(question_text),qw.questions_cards[t].question_text=w+question_text,qw.questions_cards[t].choices=[],qw.questions_cards[t].correct_choice_fs=[],qw.questions_cards[t].feedbacks=[]);for(var u,z,h=i.substr(0,n),m=(u=h.match(/\[hangman/g)).length,p=i.substr(n),g=["[c]","[c*]"],b=["[c]","[c*]","[x]",'<div class="qwizzled_question_bottom_border_title"'],v=[],f=new RegExp("\\[hangman[^\\]]*\\]"),y=[],x=0;;){var k,$="",A=0,C=qqc.parse_html_block(p,g,b);if("NA"==C)break;if(p=p.substr(C.length),q.wordpress_page_f&&(C=cvt_feedback(C)),C=(k=process_feedback_item(C,e,t,x)).choice_html,k.feedback_div)!0,v.push(k.feedback_div),set_qwizard_data_b&&(qw.questions_cards[t].feedbacks[x]=qqc.shortcodes_to_video_elements(k.feedback_item_html)),(k=process_feedback_item(C,e,t,x)).feedback_div&&errmsgs.push(T("More than one feedback shortcode [f] given with hangman answer")+".  qwiz: "+(1+e)+", "+T("question")+" "+(1+t)+", "+T("choice")+" "+(1+x));else v.push("");var j=C.match(/\[c\*{0,1}\]([^\[]*)/m);j&&($=($=j[1]).replace(/<[^>]+>|\n|&nbsp;/g,""),A=($=qqc.trim($)).length,debug[0]&&console.log("[process_hangman] hangman_answer:",$)),void 0===qwizdata[e].hangman[t]&&(qwizdata[e].hangman[t]={}),qwizdata[e].hangman[t].hangman_answer||(qwizdata[e].hangman[t].hangman_answer=[],qwizdata[e].hangman[t].hangman_final_entry=[],qwizdata[e].hangman[t].hangman_current_entry=[],qwizdata[e].hangman[t].hangman_incorrect_chars=[],qwizdata[e].hangman[t].hangman_incorrect_chars_before_hint=[],qwizdata[e].hangman[t].hangman_n_hints=[]),0==x&&(qwizdata[e].hangman[t].n_hangman=m,qwizdata[e].hangman[t].hangman_max_hints=r,qwizdata[e].hangman[t].hangman_type_letters=o,qwizdata[e].hangman[t].n_hangman_done=0,qwizdata[e].hangman[t].n_hangman_correct=0),qwizdata[e].hangman[t].hangman_answer[x]=$,set_qwizard_data_b&&(qw.questions_cards[t].choices[x]=$,qw.questions_cards[t].correct_choice_fs[x]=1),qwizdata[e].hangman[t].hangman_n_hints[x]=0;var I=qqc.create_hangman_entry($);if(qwizdata[e].hangman[t].hangman_final_entry[x]=I,!v[x]){var O=q.canned_feedback(!0);v[x]=create_feedback_div_html(e,t,x,O),set_qwizard_data_b&&(qw.questions_cards[t].feedbacks[x]=O)}var E=new Array(A).join("&ensp;"),S=q.qwizard_b?' onfocus="qwizard.update_hangman_options_menu_choice (this, '+x+')"':"",R="",W="";q.qwizard_b&&"placeholder"==$&&(R=" disabled",W=" qwiz_button_disabled");var L,B='<span class="qwiz_hangman qwiz_hangman_c'+x+'" onkeyup="'+qname+'.hangman_show (this, true)" onmouseenter="'+qname+'.hangman_show (this)" onmouseleave="'+qname+'.hangman_hide (this)"><span class="hangman_current_entry hangman_entry"></span><input type="text" oninput="'+qname+".hangman_keyup (this, event,' "+E+"', "+e+", "+t+", "+x+')" onblur="'+qname+'.hangman_hide (this.parentElement)"'+S+R+" />";if(r)L=r<$.replace(/[^a-z0-9]/i,"").length?' title="'+T("You can get")+" "+qqc.number_to_word(r)+" "+T("hint")+" "+Tplural("letter","letters",r)+", "+T("but your answer will count as incorrect")+'"':' title="'+T("You can get hints, but your answer will count as incorrect")+'"',B+='<button id="hangman_hint-qwiz'+e+"-q"+t+"-c"+x+'" class="qwiz_button hangman_hint'+W+'" onmouseenter="'+qname+'.hangman_show (this.parentElement)" onclick="'+qname+".hangman_hint ("+e+", "+t+", "+x+')"'+L+R+">"+T("Hint")+"</button>\n";o&&!q.qwizard_b&&(!s||s&&0==x)&&(B+='<span class="hangman_type_letters"></span>'),B+='<span class="hangman_status"></span></span>',q.qwizard_b&&!s?y.push(B):h=h.replace(f,B),x++}if(h=h.replace(/\[(<code><\/code>)*q[^\]]*\]/,""),x!=m&&errmsgs.push("Number of [hangman] shortcodes does not match number of hangman words [c].  qwiz: "+(1+e)+", "+T("question")+" "+(1+t)),set_qwizard_data_b&&(qw.questions_cards[t].n_choices=m),q.qwizard_b&&!s)z=create_hangman_textentry_editable_divs(e,t,w,y,"hangman",f,h);else{if(q.qwizard_b){var F=h.search(/<div[^>]+qwizzled_canvas/);if(-1!=F){var G=h.search(/<div[^>]+hangman_labeled_diagram_fields/);if(1!=G){var Y=qqc.find_matching_block(h.substr(G));h=(h=h.replace(Y,"")).substr(0,F)+Y+h.substr(F)}}}z='<div id="qwiz'+e+"-q"+t+'" class="qwizq"'+create_bg_img_style(e,t)+">\n"+w+h}return debug[0]&&console.log("[process_hangman] new_htm:",z),z+='<div style="clear: both;"></div>\n',z+=v.join("\n"),z+='<div class="qwiz_hangman_msg"></div>',z+="</div>"}this.wordpress_page_f=!1,$(document).ready(function(){qqc=qwiz_qcards_common;var e=$.cookie("qwiz_preview");void 0!==e&&(q.preview_i_qwiz_plus1=parseInt(e,10)+1,$.removeCookie("qwiz_preview",{path:"/"})),debug[0]&&(console.log("[qwiz.js > document ready] typeof (document_qwizard_user_page):",typeof document_qwizard_user_page),console.log("[qwiz.js > document ready] q.preview_i_qwiz_plus1:",q.preview_i_qwiz_plus1)),correct=[T("Good!"),T("Correct!"),T("Excellent!"),T("Great!")],incorrect=[T("No."),T("No, that's not correct."),T("Sorry, that's not correct.")];var t=document.location.href;qwizcards_page_f=-1!=t.indexOf("qwizcards.com/u/")||-1!=t.indexOf("qwizcards.com/admin/")||-1!=t.indexOf("localhost/u/")||-1!=t.indexOf("localhost/admin/")||-1!=t.indexOf("192.168.1.120/u/")||-1!=t.indexOf("192.168.1.120/admin/"),"undefined"==typeof document_qwizard_user_page&&-1==window.location.href.indexOf("action=edit")&&-1==window.location.href.indexOf("post-new")&&q.qwiz_init()}),this.qwiz_init=function(e,t){if(content=qqc.get_qwiz_param("content","body"),default_use_dict=qqc.get_qwiz_param("use_dict","true"),default_use_terms=qqc.get_qwiz_param("use_terms","true"),default_hangman_max_hints=parseInt(qqc.get_qwiz_param("hangman_hints",2),10),hint_timeout_sec=qqc.get_qwiz_param("hint_timeout_sec",20),post_id=qqc.get_qwiz_param("post_id",0),q.qwizcards_version=qqc.get_qwiz_param("qwizcards_version",""),document_qwiz_mobile_enabled="Enabled"==qqc.get_qwiz_param("mobile_enabled","Enabled"),Tcheck_answer_message=T('Need help?  Try the "hint" button'),!t&&(qqc.set_force_mobile(),process_html(),errmsgs.length&&!e&&(q.qwizard_b||(qqc.get_qwiz_param("regular_page_error_check")?alert(Tplural("Error found","Errors found",errmsgs.length)+":\n\n"+errmsgs.join("\n")):console.log("Errors found:\n",errmsgs.join("\n")))),document_qwiz_force_mobile_f&&q.go_mobile(0),n_qwizzes)){qqc.is_mobile()&&!document_qwiz_force_mobile_f&&$(".go-mobile-qwiz").show();for(var i=0;i<n_qwizzes;i++)qwizdata[i].questions&&(qwizdata[i].qrecord_id&&(qwizdata[i].record_start_b=!0),q.no_intro_b[i]||1==qwizdata[i].n_questions||q.preview_i_qwiz_plus1?q.next_question(i):qwizdata[i].display_pay_screen||($("div.intro-qwiz"+i).show(),$("div#next_button-qwiz"+i).show()));if(q.$dialog_no_credit||($("body").append(dialog_no_credit_html()),q.$usernames_is_are=$("#qwiz_usernames_is_are"),q.$dialog_no_credit=$("#qwiz_dialog_no_credit").dialog({height:300,width:550,modal:!0,autoOpen:!1,buttons:{Close:function(){q.$dialog_no_credit.dialog("close")}}})),q.preview_i_qwiz_plus1){var a=q.preview_i_qwiz_plus1-1;qwizdata[a].use_dataset||q.init_preview(a)}else q.preview&&!q.qwizard_b&&q.init_preview(0)}},this.process_html2=function(e,t,i,a){var s=new RegExp("\\[qwizdemo\\][\\s\\S]*?\\[\\/qwizdemo\\]","gm");q.qwizdemos=e.match(s),q.qwizdemos&&(e=e.replace(s,"<qwizdemo></qwizdemo>"),debug[0]&&console.log("[process_html2] q.qwizdemos.length: ",q.qwizdemos.length));var n=0,_=check_qwiz_tag_pairs(e=(e=e.replace(/<!--[^]*?-->/gm,"")).replace(/\[!+\][^]*?\[\/!+\]/gm,""));if(_)e=_;else{qwizzled_b=!1;var r=e.match(/\[qwiz[^]*?\[\/qwiz\]/gm);if(r){n=r.length,debug[0]&&(console.log("[process_html2] local_n_qwizzes: ",n),console.log("                qwiz_matches[0]: ",r[0])),q.preview_i_qwiz_plus1&&(q.preview=!0);var o=!0,d=!1;q.quizzes_questions=[];for(var c=0;c<n;c++){if(q.preview_i_qwiz_plus1&&(q.preview_i_qwiz_plus1==t+1?(d=!0,o=!0):o=!1),o){var l=q.process_qwiz_pair(r[c],t,i,a,a);if(a&&(qwizard.questions_cards&&qwizard.questions_cards.length&&(qwizard.questions_cards[0].dataset_b=qwizard.questions_cards_dataset_b,q.quizzes_questions[t]=JSON.parse(JSON.stringify(qwizard.questions_cards))),debug[0]&&(console.log("[process_html2] i_qwiz:",t,", qwizard.questions_cards:",qwizard.questions_cards),qwizard.questions_cards))){console.log("[process_html2] JSON.stringify (qwizard.questions_cards):",JSON.stringify(qwizard.questions_cards)),console.log("[process_html2] qwizard.questions_cards.length:",qwizard.questions_cards.length);for(var w=qwizard.questions_cards.length,u=0;u<w;u++)""==qwizard.questions_cards[u]&&console.log("[process_html2] NULL JSON ii:",u)}e=e.replace(/(<[ph][^>]*>\s*)*?\[qwiz[^]*?\[\/qwiz\]/m,function(){return l})}else qwizdata[t]={};t++}if(debug[0]&&q.quizzes_questions.length)for(var z=q.quizzes_questions.length,h=0;h<z;h++)console.log("[process_html2] q.quizzes_questions["+h+"]:",q.quizzes_questions[h]);debug[3]&&console.log("[process_html2] htm:",e)}}return debug[0]&&console.log("[process_html2] replace_body:",d),{htm:e,i_qwiz:t,replace_body:d}},this.reset_preview=function(e){$.cookie("qwiz_preview",e,{path:"/"}),window.location=window.location.href},this.process_reg_code=function(e){if(debug[0]&&console.log("[process_reg_code] reg_code:",e),""!=e){var t={reg_code:e};qqc.jjax(qname,0,0,"reg_code_add_to_class",t)}},this.hide_reg_code_error=function(){$("div.qwiz_reg_code_errmsg").html("").hide()},this.init_preview=function(e){$("#qwiz"+e+" div.qwizq").addClass("qwizq_preview").on("mouseenter",q.set_i_qwiz_i_question).show(),$("#qwiz"+e).css({border:"none"}),q.no_intro_b[e]||qwizdata[e].use_dataset||$("div.intro-qwiz"+e).addClass("qwiz qwizq_preview").show(),q.display_summary_and_exit(e),$("#summary-qwiz"+e).addClass("qwiz qwizq_preview").show(),$("#next_button-qwiz"+e).remove();for(var t=qwizdata[e].n_questions,i=0;i<t;i++)q.display_question(e,i,!1);init_preview_questions_active(e)},this.change_preview_mode=function(e,t){for(var i in debug[0]&&console.log("[change_preview_mode] radio_el:",e),qwizdata[t].$qwizzled)$("div#"+i).replaceWith(qwizdata[t].$qwizzled[i]),$("div#"+i).addClass("qwizq_preview").show(),qwizdata[t].$qwizzled[i]=$("div#"+i).clone(!0);$("div#qwiz"+t+" button.show_the_answer").show(),$("div#qwiz"+t+" div.show_answer_got_it_or_not").hide(),$("div#qwiz"+t+" div.qwiz-feedback").hide(),"questions_active"==(preview_mode=e.value)?init_preview_questions_active(t):init_preview_show_answers(t)},this.set_i_qwiz_i_question=function(){debug[0]&&console.log("[set_i_qwiz_i_question] this:",this);var e=this.id,t=e.match(/qwiz([^-]+)/)[1],i=e.match(/-q(.+)/)[1];qwizdata[t].i_question=i},this.init_qwizzled=function(e,t,i){var a;debug[0]&&console.log("[init_qwizzled] i_qwiz:",t),sibs={};var s=0;e.find("div.qwizzled_canvas .qwizzled_target").each(function(){var e=$(this);e.removeClass("ui-draggable ui-draggable-handle"),e.css({"border-style":"dotted","border-color":"gray"});var t=e.attr("class").match(/qtarget_sib-([0-9]+)/);if(t){var i=t[1];sibs[i]?a=sibs[i]:(a="t"+s,sibs[i]=a,s++)}else a="t"+s,s++;e.attr("id",a),e.on("click",function(e){debug[8]&&console.log("[target clicked] $ (event.target):",$(e.target));var t=$(e.target);t.hasClass("qwizzled_target")&&(t.droppable("option","disabled")||q.label_dropped(t))})}),e.find("td.qwizzled_labels div.qwizzled_label").each(function(){$(this).on("click",function(e){if(debug[8]&&console.log("[label clicked] $ (event.target).html ():",$(e.target).html()),ignore_label_click_b)ignore_label_click_b=!1;else{var t,i=(t="div"==e.target.tagName.toLowerCase()?$(e.target):$(e.target).parents("div.qwizzled_label"))[0].id.match(/qwiz([^-]+)/)[1];$label_clicked[i]=t;var a=t.parents("td.qwizzled_labels");a.find(".qwizzled_highlight_label").removeClass("label_click_highlight"),a.find(".qwizzled_label_head").hide(),a.find(".qwizzled_label_head_label_clicked").show(),t.find(".qwizzled_highlight_label").addClass("label_click_highlight"),q.label_dragstart(t,!0)}})}),e.find("div.qwizzled_canvas div.ui-resizable-handle").remove(),e.find("div.qwizzled_image div.qwizzled_target").css("border-width","2px"),e.find(".qwizzled_highlight_label").css("border","none"),e.find(".qwizzled_highlight_label *").css("word-wrap","normal"),e.find("div.qwizzled_image").each(function(){var e=$(this).width(),t=$(this).height();$(this).find("img").attr("width",e).attr("height",t).removeAttr("sizes").removeAttr("srcset")}),q.init_qwizzled2(e,t,i)},this.init_qwizzled2=function(e,t,i){var a=$("#xqwiz"+t).outerWidth();debug[0]&&console.log("[init_qwizzled2] i_qwiz:",t,", i_question:",i,", initial_width:",a),a&&(qwizdata[t].initial_width=a),qwizdata[t].$qwizzled||(qwizdata[t].$qwizzled={});var s="qwiz"+t+"-q"+i;qwizdata[t].$qwizzled[s]=e.clone(!0)},this.init_textentry_autocomplete=function(e){debug[6]&&console.log("[init_textentry_autocomplete]"),e.find("input.qwiz_textentry").autocomplete({source:find_matching_terms,close:menu_closed,open:menu_shown,select:q.item_selected}),e.find("input.qwiz_textentry").keyup(menu_closed),e.find("input.qwiz_single_char_entry").keyup(single_char_textentry_keyup)},this.label_dragstart=function(e,t){var i=e[0].id.match(/qwiz([^-]+)/)[1];if(t)debug[8]&&console.log("[label_dragstart] $label_clicked[i_qwiz].html():",$label_clicked[i].html());else{if($label_clicked[i]){$label_clicked[i].find(".qwizzled_highlight_label").removeClass("label_click_highlight");var a=e.parents("td.qwizzled_labels");a.find(".qwizzled_label_head").hide(),a.find(".qwizzled_label_head_standard").show(),$label_clicked[i]=""}$prev_label_clicked[i]=0}if(try_again_obj&&$prev_label_clicked[i]!==$label_clicked[i]){var s=try_again_obj;try_again_obj="",debug[8]&&(console.log("[label_dragstart] $label.html():",e.html()),console.log("[label_dragstart] local_try_again_obj:",s),console.log("[label_dragstart] local_try_again_obj.$label.attr ('id'):",s.$label.attr("id"))),s.$label.find(".qwizzled_highlight_label").css({background:""}),s.$label.find(".qwizzled_highlight_label img").css({outline:""}),s.$label.attr("id")!=e.attr("id")&&(s.$label.animate({left:"0px",top:"0px"},{duration:750}),s.$label.find(".qwizzled_highlight_label").removeClass("label_click_highlight")),s.$feedback.hide(),s.$target.droppable("enable")}$prev_label_clicked[i]=""},this.label_dropped=function(e,t){if(debug[8]&&console.log("[label_dropped]: $target:",e,", $label:",t),t)ignore_label_click_b=!0;else{var i=e.parents("div.qwizq")[0].id.match(/qwiz([^-]+)/)[1];if(!$label_clicked[i])return!1;debug[8]&&console.log("[label_dropped]: $label_clicked[i_qwiz]:",$label_clicked[i]);var a=(t=$label_clicked[i]).parents("td.qwizzled_labels");a.find(".qwizzled_label_head").hide();var s=document_qwiz_mobile?"mobile":"standard";a.find(".qwizzled_label_head_"+s).show()}(_=t.attr("class").match(/qwizzled_n_targets([0-9]*)/))||t.find(".qwizzled_highlight_label").removeClass("label_click_highlight");var n,_=t.attr("class").match(/qtarget_assoc([0-9]+)/);n=_?_[1]:t.data("label_target_id"),debug[8]&&console.log("[label_dropped] $target:",e,", assoc_id:",n);var r="#"+t.attr("id").substr(6),o=r.split("-"),d=o[0]+"-"+o[1],c=(i=o[0].substr(5),o[1].substr(1));if(debug[8]&&console.log("[label_dropped] question_selector:",d),qwizdata[i].record_start_b&&document_qwiz_user_logged_in_b){qwizdata[i].record_start_b=!1;var l={qrecord_id_ok:qwizdata[i].qrecord_id_ok,type:"start",confirm:"js"};qqc.jjax(qname,i,qwizdata[i].qrecord_id,"record_response_v3",l)}1!=qwizdata[i].user_question_number||!q.no_intro_b[i]&&1!=qwizdata[i].n_questions||($("div#icon_qwiz"+i).hide(),alert_not_logged_in(i)),qwizdata[i].n_label_attempts++,$("[id^=qwiz"+i+"-q"+c+"-a]").hide();var w="#qwiz"+i+"-q"+c,u=!1;if(qwizdata[i].qrecord_id&&document_qwiz_user_logged_in_b)if(qqc.isInteger(qwizdata[i].dataset_id[c])){if(!qwizdata[i].q_and_a_text[c]){var z,h=$(w+" div.qwizzled_image img").attr("src");h?z=h:h="",$(w+" div.qwizzled_label").each(function(){var e=$(this).html();e&&(z+="\t"+e)}),z=qqc.remove_tags_eols(z),qwizdata[i].q_and_a_text[c]=qqc.q_and_a_hash(z),qwizdata[i].q_and_a_crc32[c]=qwiz_crc32($(w).html()),debug[0]&&console.log("[label_dropped] qwizdata[i_qwiz].q_and_a_crc32[i_question]:",qwizdata[i].q_and_a_crc32[c])}}else qwizdata[i].q_and_a_text[c]=qwizdata[i].dataset_id[c],qwizdata[i].q_and_a_crc32[c]="dataset";var m=!1;if(e.hasClass("qwizzled_target-"+n))if(debug[8]&&(console.log("[label_dropped] feedback_selector:",r+"c"),console.log("[label_dropped] qwizdata[i_qwiz].n_questions:",qwizdata[i].n_questions)),$(r+"c").show(),place_label(e,t),qwizdata[i].n_labels_correct++,qwizdata[i].n_labels_correct==qwizdata[i].n_label_targets){m=!0;var p,g=qwizdata[i].n_label_attempts,b=qwizdata[i].n_label_targets;(u=g==b)?p="You placed all of the items correctly on the first try!":(p=(p=Tplural("It took you one try","It took you %s tries",g)+" "+Tplural("to place this label correctly","to place these labels correctly",b)+".").replace("%s",qqc.number_to_word(g)),1==qwizdata[i].n_questions&&qwizdata[i].repeat_incorrect_b&&(p+="<br />Re-do those you did not label correctly ",qwizdata[i].qrecord_id&&document_qwiz_user_logged_in_b&&(p+="to get this question marked &ldquo;correct&rdquo; "),p+='<button class="qwiz_button" onclick="qwiz_.next_question ('+i+', true)">Re-do</button>',q.qwizard_b||(qwizdata[i].answered_correctly[c]=-1))),$(w+"-ff").html(p).show(),qwizdata[i].n_questions>1||qwizdata[i].use_dataset?(q.qwizard_b||(qwizdata[i].answered_correctly[c]=u?1:-1,u?qwizdata[i].n_correct++:qwizdata[i].n_incorrect++,update_topic_statistics(i,c,u)),update_progress_show_next(i)):display_qwizzled_progress(i),update_progress_show_next(i)}else{var v=e.attr("id");void 0===qwizdata[i].correct_on_try1[c]&&(qwizdata[i].correct_on_try1[c]={}),qwizdata[i].correct_on_try1[c][v]||(qwizdata[i].correct_on_try1[c][v]=1),display_qwizzled_progress(i)}else{if(debug[8]&&(console.log("[label_dropped] feedback_selector:",r+"x"),console.log("[label_dropped] qwizdata[i_qwiz].n_questions:",qwizdata[i].n_questions)),$label_clicked[i]){var f=e.offset(),y=f.left,x=f.top,k=$label_clicked[i].data("label_x"),A=$label_clicked[i].data("label_y");debug[8]&&(console.log("[label_dropped] target_x:",y,", target_y:",x),console.log("[label_dropped] label_x:",k,", label_y:",A)),t.css({left:y-k+"px",top:x-A+"px"}),$label_clicked[i]=""}t.find(".qwizzled_highlight_label").css({background:"#FF8080"}),t.find(".qwizzled_highlight_label img").css({outline:"2px solid #FF8080"});var T=$(r+"x");T.show(),try_again_obj={$label:t,$feedback:T,$target:e},e.droppable("disable");v=e.attr("id");void 0===qwizdata[i].correct_on_try1[c]&&(qwizdata[i].correct_on_try1[c]={}),qwizdata[i].correct_on_try1[c][v]=-1}if(qwizdata[i].qrecord_id&&document_qwiz_user_logged_in_b){var C=t.find("span.qwizzled_highlight_label").html();C=qqc.remove_tags_eols(C);var j=e.attr("class").match(/qwizzled_target-([0-9]*)/)[1],I=$(w).find("div.qtarget_assoc"+j).find("span.qwizzled_highlight_label").html();I||(I=$(w).find('div.qwizzled_label[data-label_target_id="'+j+'"]').find("span.qwizzled_highlight_label").html()),I=qqc.remove_tags_eols(I);l={q_and_a_text:btoa(encodeURIComponent(qwizdata[i].q_and_a_text[c])),q_and_a_crc32:qwizdata[i].q_and_a_crc32[c],i_question:qwizdata[i].dataset_id[c],unit:qwizdata[i].unit[c],type:"labeled_diagram",response:C+"\t"+I,correct_b:"",confirm:"js"};if(qqc.jjax(qname,i,qwizdata[i].qrecord_id,"record_response_v3",l),m){l={q_and_a_text:btoa(encodeURIComponent(qwizdata[i].q_and_a_text[c])),q_and_a_crc32:qwizdata[i].q_and_a_crc32[c],i_question:qwizdata[i].dataset_id[c],unit:qwizdata[i].unit[c],type:"labeled_diagram",response:"done",correct_b:u?1:"",confirm:"js"};setTimeout(function(){qqc.jjax(qname,i,qwizdata[i].qrecord_id,"record_response_v3",l)},500)}}},this.process_qwiz_pair=function(e,t,i,a,s){q.qwizard_b=i,"undefined"!=typeof qwizard&&(qw=qwizard),a?(n_qwizzes=1,set_qwizard_data_b=!0,q.no_intro_b=[],debug[0]&&console.log("[process_qwiz_pair] htm.substr (0, 2000):",e.substr(0,2e3))):set_qwizard_data_b=!1,qwizdata[t]={},qwizdata[t].questions=[],qwizdata[t].answered_correctly=[],qwizdata[t].n_correct=0,qwizdata[t].n_incorrect=0,qwizdata[t].i_question=-1,qwizdata[t].i_user_question=-1,qwizdata[t].user_question_number=0,qwizdata[t].initial_width=500,qwizdata[t].hangman={},qwizdata[t].use_dataset="",qwizdata[t].dataset_id={},qwizdata[t].use_dataset_question_ids={},qwizdata[t].bg_img={},qwizdata[t].align="",qwizdata[t].qrecord_id="",qwizdata[t].qrecord_id_ok="check credit",qwizdata[t].information_question_b={},qwizdata[t].unit=[],qwizdata[t].parts_htm={};var n=(v=e.match(/\[qwiz([^\]]*)\]/m))[0],_=v[1];n=qqc.replace_smart_quotes(n),_=qqc.replace_smart_quotes(_),debug[0]&&(console.log("[process_qwiz_pair] qwiz_tag: ",n),console.log("[process_qwiz_pair] attributes: ",_)),set_qwizard_data_b&&qw.set_qwizard_data("qwiz_deck_attributes",_);var r=!1;qwizdata[t].summary_b="false"!=get_attr(n,"summary");var o=get_attr(n,"use_dataset",!0);if(o){qwizdata[t].use_dataset=o;var d=get_attr(n,"dataset_intro");d&&"true"!=d?"false"==d&&(d=!1):d=!0,qwizdata[t].dataset_intro_f=d;var c="false"!=get_attr(n,"spaced_repetition");if(qwizdata[t].dataset_questions_to_do=c?"spaced_repetition":"all",qwizdata[t].random_b="true"==get_attr(n,"random"),v=n.match(/\sstyle\s*=\s*"[^"]+"/gm))for(var l=v.length,w=0;w<l;w++){var u=encodeURIComponent(v[w]);n=n.replace(v[w],u)}var z=get_attr(n,"display_name");if(z){qwizdata[t].use_dataset_options_display_name=decodeURIComponent(z);n=n.replace(/\sdisplay_name\s*=\s*"[^"]*?"/,"")}n=decodeURIComponent(n)}var h=get_attr(_,"align");"center"!=h&&"right"!=h&&"tiled"!=h||(qwizdata[t].align=h,"tiled"==h&&(qwizdata[t].spacing=20));var m=parseInt(get_attr(_,"spacing"));qqc.isInteger(m)&&(qwizdata[t].spacing=m),qwizdata[t].hide_forward_back_b="true"==get_attr(n,"hide_forward_back"),qwizdata[t].hide_progress_b="true"==get_attr(n,"hide_progress"),qwizdata[t].hide_qwizcards_icon_b="true"==get_attr(n,"hide_qwizcards_icon");var p=get_attr(_,"qrecord_id");if(p){qwizdata[t].qrecord_id=p,qwizdata[t].q_and_a_text={},qwizdata[t].q_and_a_crc32={},q.qrecord_b||(q.qrecord_b=!0,"undefined"!=typeof document_qwiz_user_logged_in_b&&"not ready"!=document_qwiz_user_logged_in_b||qqc.check_session_id(t));var g=get_attr(_,"display_pay_screen");g&&"false"!=g?("true"==g||"login"==g?g="login":"register"==g&&(g="register"),qwizdata[t].display_pay_screen=g):g=""}(q.qwizard_b||set_qwizard_data_b)&&get_attr(_,"dataset")&&(q.dataset_b=!0,set_qwizard_data_b&&(qw.questions_cards_dataset_b=!0));var b=get_attr(_,"unit");b?(qwizdata[t].default_unit=b.replace(/\s/g,"_"),set_qwizard_data_b&&qw.set_qwizard_data("default_unit",b)):qwizdata[t].default_unit="null";var v,f="",y=!1;if(v=e.match(/\[qwiz[^\]]*\]((<\/[^>]+>\s*)*)/m,"")){var x=v[1];debug[0]&&console.log("[process_qwiz_pair] initial_closing_tags: ",x)}l=(e=e.replace(/\[qwiz[^\]]*\]((<\/[^>]+>\s*)*)/m,"")).length;e=e.substring(0,l-7);var k=(v=(e=qqc.trim(e)).match(/\[(q|<code><\/code>q)([^\]]*)\]/gm))?v.length:0;if(o||q.qwizard_b||0!=k){e=qqc.process_inline_textentry_terms(e,"terms",qwizdata,t),errmsgs=errmsgs.concat(qwizdata.additional_errmsgs),e=qqc.process_inline_textentry_terms(e,"add_terms",qwizdata,t),errmsgs=errmsgs.concat(qwizdata.additional_errmsgs);var $=qqc.parse_html_block(e.substr(0,2e3),["^"],["[h]","[i]","[q]","[q "],"[<code></code>q","return whitespace");$&&(e=e.replace($,"")),e=process_header(e,t,0,!0),set_qwizard_data_b&&"NA"!=header_html&&qw.set_qwizard_data("header_text",header_html);var A=qqc.parse_html_block(e.substr(0,5e3),["[i]"],["[q]","[q ","[<code></code>q",'<div class="qwizzled_question',"[x]"]);if("NA"==A)""==(A=qqc.parse_html_block(e.substr(0,5e3),["^"],["[q]","[q ","[<code></code>q",'<div class="qwizzled_question',"[x]"],!0))&&(o?A="<br /><br /><br />":y=!0);else{var C=e.substr(0,200);C=qqc.trim(C);var j=qqc.opening_tag_shortcode_pos("[i]",C);C=C.substr(j,5);var I=A.replace(/<br[^>]*>/g,"");C!=(I=qqc.trim(I).substr(0,5))&&errmsgs.push(T("Text before intro")+" [i].  qwiz: "+(t+1)),A=A.replace("[i]",""),A=qqc.balance_closing_tag(A)}q.qwizard_b&&(A=qqc.shortcodes_to_video_elements(A)),y&&!q.qwizard_b||(debug[0]&&console.log("[process_qwiz_pair] intro_html:",A),f+='<div class="intro-qwiz'+t+' qwiz-intro qwiz_editable">'+qqc.decode_image_tags(A)+"</div>\n"),set_qwizard_data_b&&qw.set_qwizard_data("intro_text",A);var O=qqc.parse_html_block(e,["[x]"],[]);if("NA"!=O)if(-1!=(O=O.replace(/\[x\]/,"")).search(/\[q[ \]]|<div class="qwizzled_question/))errmsgs.push("[x] "+T("(exit text) must be last")+".  qwiz: "+(t+1));else{var E=qqc.opening_tag_shortcode_pos("[x]",e);e=e.substr(0,E)}else O="";if(set_qwizard_data_b){var S=qqc.shortcodes_to_video_elements(O);qw.set_qwizard_data("exit_text",S)}o||-1!=e.search(/use_dataset_question\s*=\s*/)&&(r=!0,qwizdata[t].use_dataset_questions_htm=e),o||r&&!s?(s&&(qwizard.questions_cards_dataset_b=!1),f+='<div id="dataset_questions-qwiz'+t+'"></div>'):0==k?(qwizdata[t].n_questions=0,f+='<div id="qwiz'+t+'-q-1" class="qwizq"></div>'):(qwizdata[t].n_questions=k,qwizdata[t].n_questions_for_done=k,f=q.process_questions(e,f,t))}else errmsgs.push(T('Did not find question tags ("[q]")')+".  qwiz: "+(t+1)),header_html="";return q.no_intro_b[t]=y,f=create_qwiz_divs(t,n,f,O),void 0!==q.qwizard_b&&(qwizard.errmsgs=errmsgs),f},this.process_questions=function(e,t,i,a,s){s&&(qw=qwizard,n_qwizzes=1,set_qwizard_data_b=!0,q.qwizard_b=!0),number_first_question=void 0!==a?a:0,set_qwizard_data_b||-1!=e.indexOf("[!")&&(e=e.replace(/\[!+\][^]*?\[\/!+\]/gm,""));var n=e.match(/(\[q [^\]]*\]|<div class="qwizzled_question|\[q\])[^]*/m)[0],_=n.match(/\[(<code><\/code>)*q([^\]]*)\]/gm);(debug[4]||debug[11])&&console.log("[process_questions] question_shortcodes: ",_),n_questions=_.length,qwizdata[i].question_topics=new Array(n_questions),q.qwizard_b&&(qwizdata[i].qwizard_multiple_choice_b=[]),qwizdata[i].units=[],qwizdata[i].topics=[];for(var r=e.match(/(<[^\/][^>]*>\s*)*?(\[q[ \]]|\[<code><\/code>q)/gm),o=[],d=r.length,c=0;c<d;c++){var l=r[c];l=(l=l.replace(/\[q[ \]]|\[<code><\/code>q/gm,"")).replace(/[^]*<(img|input)[^>]+>/,""),o.push(l)}(debug[0]||debug[11])&&(console.log("[process_questions] q_opening_tags: ",o),console.log("[process_questions] question_html: ",n));var w="[q"!=n.substr(0,2);if(w)n=n.replace(/<div class="qwizzled_question[^>]*>/,"");else{var u=n.indexOf("]")+1;n=n.substr(u)}var z=n.split(/<div class="qwizzled_question[^_][^>]*>/);(debug[0]||debug[11])&&console.log("[process_questions] qwizzled_pieces.length:",z.length);var h=[];if(1==z.length){var m=n.split(/\[q [^\]]*\]|\[<code><\/code>q [^\]]*\]|\[q\]|\[<code><\/code>q\]/),p=0;w&&(h.push(m[0]+"[q]"+m[1]),p=2);for(var g=p;g<m.length;g++)h.push(m[g])}else if(z.length>1)if(w)for(var b=0;b<z.length;b++){m=z[b].split(/\[q [^\]]*\]|\[<code><\/code>q [^\]]*\]|\[q\]|\[<code><\/code>q\]/);h.push(m[0]+"[q]"+m[1]);for(g=2;g<m.length;g++)h.push(m[g])}else{for(m=z[0].split(/\[q [^\]]*\]|\[q\]/),g=0;g<m.length;g++)h.push(m[g]);for(b=1;b<z.length;b++){m=z[b].split(/\[q [^\]]*\]|\[<code><\/code>q [^\]]*\]|\[q\]|\[<code><\/code>q\]/);h.push(m[0]+"[q]"+m[1]);for(g=2;g<m.length;g++)h.push(m[g])}}set_qwizard_data_b&&void 0===a&&qw.set_qwizard_data("n_questions",n_questions),q.qwizard_b||(qwizdata[i].n_questions_for_done=n_questions,qwizdata[i].n_questions=n_questions),(debug[0]||debug[11])&&(console.log("[process_questions] n_questions:",n_questions),console.log("[process_questions] questions_html:",h.join("\n================================================\n")));for(var v,f=[],y=!1,x=0;x<n_questions;x++){var k,$=x+number_first_question;if(k=void 0!==a?_[0]:_[$],question_topic=process_question_attributes(i,$,k,a),question_topic&&(y=!0),-1!=h[x].indexOf("[hangman")||-1!=h[x].indexOf("hangman_img_wrapper"))v=process_hangman(i,$,h[x],o[x]);else if(-1!=h[x].indexOf("[textentry"))v=process_textentry(i,$,h[x],o[x]);else if(-1!=h[x].search(/\[c\]|\[c\*\]/m))v=process_multiple_choice(i,$,h[x],o[x]);else if(-1!=h[x].search(/<div[^>]+class=".*?qwizzled_label/m))qwizzled_b=!0,qwizdata[i].qwizzled_b=!0,v=process_qwizzled(i,$,h[x],o[x],_[x]),qwizdata[i].correct_on_try1?qwizdata[i].correct_on_try1[$]={}:qwizdata[i].correct_on_try1=[];else{var A,C=h[x],j=C.replace(/<[^>]+>|&nbsp;|\s/gm,"");if(j||-1!=C.indexOf("img")&&(j=!0),j){if(qwizdata[i].information_question_b[$]=!0,qwizdata[i].qrecord_id)qqc.isInteger(qwizdata[i].dataset_id[$])?(A=qqc.remove_tags_eols(C),qwizdata[i].q_and_a_text[$]=qqc.q_and_a_hash(A),qwizdata[i].q_and_a_crc32[$]=qwiz_crc32(h[x])):(qwizdata[i].q_and_a_text[$]=qwizdata[i].dataset_id[$],qwizdata[i].q_and_a_crc32[$]="dataset")}else qwizdata[i].use_dataset_question_ids[$]||errmsgs.push(T("Question is completely blank")+".  qwiz: "+(i+1)+", "+T("question")+" "+($+1));set_qwizard_data_b&&(qw.questions_cards[$].type="information_only",C=qqc.shortcodes_to_video_elements(C),qw.questions_cards[$].question_text=o[x]+C),v='<div id="qwiz'+i+"-q"+$+'" class="qwizq"'+create_bg_img_style(i,$)+'>\n<div class="qwiz-question qwiz_editable">'+o[x]+C+"</div></div>"}f.push(v)}return t+=f.join("\n"),y&&debug[4]&&console.log("[process_questions] topics: "+qwizdata[i].topics.join("; ")),set_qwizard_data_b&&(qw.unit_names=qwizdata[i].units),qwizdata[i].topics.length&&(check_questions_have_topics(i),set_qwizard_data_b&&(qw.topic_names=qwizdata[i].topics)),(debug[3]||debug[11])&&console.log("[process_questions] new_htm: ",t),debug[12]&&console.log("[process_questions] errmsgs: ",errmsgs.join("\n")),t},this.qwiz_password_focus=function(e,t){e.qwiz_pw="",e.value="",$("#qwiz_login-qwiz"+t+" p.login_error").hide()},this.restart_quiz=function(e){var t=$("#summary-qwiz"+e);for(var i in t.hide(),t.find("button.summary_exit_mobile_qwiz").hide(),$("#qwiz"+e+" div.show_answer_got_it_or_not").hide(),1==qwizdata[e].n_questions&&$("#qwiz"+e+" div.single-question_exit").hide(),qwizdata[e].n_correct=0,qwizdata[e].n_incorrect=0,qwizdata[e].use_dataset&&(qwizdata[e].information_question_b={},qwizdata[e].hangman={},qwizdata[e].textentry=""),q.display_progress(e),qwizdata[e].$qwizzled)$("div#"+i).replaceWith(qwizdata[e].$qwizzled[i]),qwizdata[e].$qwizzled[i]=$("div#"+i).clone(!0);qwizdata[e].qwizzled_b&&(qwizdata[e].correct_on_try1=[]),$("#qwiz"+e).find("div.qwizq").hide();for(var a=qwizdata[e].n_questions,s=0;s<a;s++)qwizdata[e].answered_correctly[s]=0,qwizdata[e].questions[s]={};qwizdata[e].hide_forward_back_b||($(".bbfe-qwiz"+e).css({visibility:"visible",color:"lightgray"}).removeClass("hover"),$("span.question-number-qwiz"+e).css({visibility:"visible"}).html(1));for(var n=qwizdata[e].topics.length,_=0;_<n;_++){var r=qwizdata[e].topics[_];qwizdata[e].topic_statistics[r].n_correct=0,qwizdata[e].topic_statistics[r].n_incorrect=0}if(qwizdata[e].i_question=-1,qwizdata[e].i_user_question=-1,qwizdata[e].user_question_number=0,qwizdata[e].qrecord_id&&document_qwiz_user_logged_in_b){qwizdata[e].record_start_b=!1;var o={qrecord_id_ok:qwizdata[e].qrecord_id_ok,type:"start",confirm:"js"};qqc.jjax(qname,e,qwizdata[e].qrecord_id,"record_response_v3",o)}q.next_question(e,!0)},this.redo_question=function(e){1==qwizdata[e].n_questions&&$("#qwiz"+e+" div.single-question_exit").hide(),qwizdata[e].i_question=qwizdata[e].i_question-1,qwizdata[e].answered_correctly[0]=0,qwizdata[e].n_correct=0,q.next_question(e,!0)},this.next_question=function(e,t,i){if(debug[0]&&console.log("[next_question] qwizdata[i_qwiz].i_question:",qwizdata[e].i_question),i=!!i,qwizdata[e].bck_f)q.fwd_question(e,!1);else{var a=qwizdata[e].i_question;-1==a&&(qwizdata[e].use_dataset&&qwizdata[e].dataset_intro_f||$(".bbfe-qwiz"+e).css({visibility:"visible",color:"lightgray"}).removeClass("hover"));var s=qwizdata[e].n_questions;debug[0]&&console.log("[next_question] i_question: ",a,", n_questions: ",s);var n="qwiz"+e,_=$("#"+n);document_qwiz_mobile?_.css("width",""):qwizdata[e].width_reset&&($("#xqwiz"+e).length?_.css({width:qwizdata[e].initial_width+"px","max-width":""}):_.css({width:"","max-width":""}),_.css({transform:""}),_[0].qscale_fac="",_[0].qstart_left="",_[0].qstart_top="",qwizdata[e].width_reset=!1);var r=!1;if(-1!=a||i){var o=n+"-q"+a;if($("#"+o).hide(),document_qwiz_mobile&&$("#mobile_"+o).hide(),qwizdata[e].pay_quiz_deck_id&&("preview_questions"==qwizdata[e].pay_quiz_ok||"preview_period_expired"==qwizdata[e].pay_quiz_ok||"no_free_trial"==qwizdata[e].pay_quiz_ok)&&qqc.preview_limit("qwiz",qwizdata,e))return}else if(qwizdata[e].use_dataset||qwizdata[e].use_dataset_questions_htm||s>1||q.qwizard_b){var d=-1;if(!q.no_intro_b[e]||qwizdata[e].use_dataset_questions_htm){if(r=!0,!t&&!q.qwizard_b&&qwizdata[e].qrecord_id){var c="undefined"!=typeof document_qwiz_user_logged_in_b&&document_qwiz_user_logged_in_b&&"undefined"!=typeof document_qwiz_username;if(!(c||"undefined"!=typeof document_qwiz_declined_login_b&&document_qwiz_declined_login_b))return q.display_login(e),!1;if(c){var l=!0;if(!$.cookie("qwiz_current_login_lt_nmin_ago")){l=!1;var w="";if(document_qwiz_team_b&&(w=" "+T("a team")+":"),confirm(T("You are logged in as")+w+" "+document_qwiz_username+".\n"+T('Do you want to continue?  (Click "Cancel" to sign out)'))){var u={path:"/",expires:qqc.get_qwiz_param("login_timeout_min",40)/1440};$.cookie("qwiz_current_login_lt_nmin_ago",1,u)}else qqc.sign_out(),document_qwiz_user_logged_in_b=!1}if(l&&document_qwiz_team_b&&!confirm(T("You are logged in as team")+": "+document_qwiz_username+".\n"+T("Do you want to continue as this team?"))){document_qwiz_session_id=document_qwiz_session_id.split(";")[0],document_qwiz_username=document_qwiz_username.split("; ")[0],document_qwiz_team_b=!1,qqc.set_user_menus_and_icons();var z=T("OK.  Only %s is logged in now");z=z.replace("%s",document_qwiz_username),alert(z)}if(qwizdata[e].record_start_b=!1,document_qwiz_user_logged_in_b){var h={qrecord_id_ok:qwizdata[e].qrecord_id_ok,type:"start",confirm:"js"};qqc.jjax(qname,e,qwizdata[e].qrecord_id,"record_response_v3",h)}}}if(qwizdata[e].use_dataset||qwizdata[e].use_dataset_questions_htm){var m=qwizdata[e].dataset_intro_f;m&&"topics_only"!=m?q.display_login(e,!1,"use_dataset_options"):($(".intro-qwiz"+e).hide(),qqc.get_dataset_questions(qwizdata[e].use_dataset,qname,e,qwizdata[e].qrecord_id,[],[],1e4,qwizdata[e].dataset_questions_to_do,qwizdata[e].random_b,qwizdata[e].use_dataset_questions_htm),d=0)}}q.next_question_from_intro(e,d)}else $("#mode-"+n).css("visibility","hidden");if(0!=s){if(next_button_active_b||($("#next_button-"+n).hide(),qwizdata[e].next_button_show_b=!1),(-1!=a||i)&&qwizdata[e].information_question_b[a]&&($("#next_button_text-qwiz"+e).html(T("Next question")),!q.qwizard_b&&(qwizdata[e].answered_correctly[a]=1,qwizdata[e].n_correct++,q.display_progress(e),1!=qwizdata[e].user_question_number||!q.no_intro_b[e]&&1!=qwizdata[e].n_questions||($("div#icon_qwiz"+e).hide(),alert_not_logged_in(e)),qwizdata[e].qrecord_id&&document_qwiz_user_logged_in_b))){h={q_and_a_text:btoa(encodeURIComponent(qwizdata[e].q_and_a_text[a])),q_and_a_crc32:qwizdata[e].q_and_a_crc32[a],i_question:qwizdata[e].dataset_id[a],unit:qwizdata[e].unit[a],type:"information_only",response:"continue",correct_b:1,confirm:"js"};qqc.jjax(qname,e,qwizdata[e].qrecord_id,"record_response_v3",h)}if(!qwizdata[e].use_dataset||-1!=a||i&&!q.qwizard_b){var p=qwizdata[e].n_correct;qwizdata[e].repeat_incorrect_b||(p+=qwizdata[e].n_incorrect);var g=qwizdata[e].n_questions_for_done;if(debug[0]&&console.log("[next_question] n_done:",p,", n_questions:",s,", n_questions_for_done:",g),p==g){d=qwizdata[e].i_user_question;qwizdata[e].questions[s]={i_user_prev_question:d,user_question_number:"--"},qwizdata[e].questions[d].i_user_next_question=s,qwizdata[e].i_user_question=s,qwizdata[e].saved_i_question=s,$("span.question-number-qwiz"+e).html("--"),q.display_summary_and_exit(e)}else{for(!q.qwizard_b&&qwizdata[e].random_b&&(a=Math.floor(Math.random()*s));;)if(++a>=s&&(a=0),qwizdata[e].repeat_incorrect_b){if(1!=qwizdata[e].answered_correctly[a])break}else if(void 0===qwizdata[e].answered_correctly[a]||0==qwizdata[e].answered_correctly[a])break;var b=qwizdata[e].i_user_question;qwizdata[e].i_question=a,void 0===qwizdata[e].questions[a]&&(qwizdata[e].questions[a]={});var v=qwizdata[e].questions[a];if(v.i_user_prev_question=b,-1==b)qwizdata[e].i_first_user_question=a,debug[0]&&console.log("[next_question] i_first_user_question:",a);else{var f=qwizdata[e].questions[b];f?f.i_user_next_question=a:console.log("[next_question] prev_question for i_prev_question",b,"does not exist"),q.qwizard_b||$(".bck-question-qwiz"+e).css({color:"gray"}).addClass("hover")}qwizdata[e].i_user_question=a,void 0===v.user_question_number&&(qwizdata[e].user_question_number++,v.user_question_number=qwizdata[e].user_question_number),q.qwizard_b||$("span.question-number-qwiz"+e).html(v.user_question_number),q.display_question(e,a,r),q.qwizard_b&&s&&(qwizard.set_qwizard_data("i_question",a),qwizard.go_to_question2(),q.display_progress(e))}}}else debug[0]&&console.log("[next_question] n_questions:",s)}},this.next_question_from_intro=function(e,t){qwizdata[e].n_questions&&($(".intro-qwiz"+e).hide(),q.no_intro_b[e]||$("#icon_qwiz"+e).hide(),$(".bbfe-qwiz"+e).css({visibility:"visible",color:"lightgray"}).removeClass("hover"),$("span.question-number-qwiz"+e).html(1),$("#next_button-qwiz"+e).css("text-align","left"),qwizdata[e].use_dataset||qwizdata[e].use_dataset_questions_htm||q.display_progress(e,!0),$("#next_button_text-qwiz"+e).html(T("Next question")))},this.bck_question=function(e,t){if($(".bck-question-qwiz"+e).hasClass("hover")){qwizdata[e].bck_f=!0;var i=qwizdata[e].i_user_question,a=i;if(t){if(qwizdata[e].use_dataset&&qwizdata[e].dataset_intro_f)return qwizdata[e].saved_i_question=qwizdata[e].i_question,$(".bck-question-qwiz"+e).css({color:"lightgray"}).removeClass("hover"),$(".fwd-question-qwiz"+e).css({color:"gray"}).addClass("hover"),$("span.question-number-qwiz"+e).html("--"),hide_current_question(e,a),qwizdata[e].i_question=-1,void q.display_login(e,!1,"use_dataset_options");i=qwizdata[e].i_first_user_question}else if(-1==(i=qwizdata[e].questions[i].i_user_prev_question))return;hide_current_question(e,a),$("div#summary-qwiz"+e).hide(),qwizdata[e].i_user_question=i;var s=qwizdata[e].questions[i];if(t||-1==s.i_user_prev_question){var n=$(".bck-question-qwiz"+e);qwizdata[e].use_dataset&&qwizdata[e].dataset_intro_f&&(n=n.last()),n.css({color:"lightgray"}).removeClass("hover")}var _=s.user_question_number;$("span.question-number-qwiz"+e).html(_),$(".fwd-question-qwiz"+e).css({color:"gray"}).addClass("hover"),qwizq_id="qwiz"+e+"-q"+i,$("#"+qwizq_id).show(),document_qwiz_mobile&&$("#mobile_"+qwizq_id).show()}},this.fwd_question=function(e,t){if($(".fwd-question-qwiz"+e).hasClass("hover")){if(-1==qwizdata[e].i_question)$("#qwiz_login-qwiz"+e).hide();else{var i=qwizdata[e].i_user_question,a="qwiz"+e+"-q"+i;$("#"+a).hide(),document_qwiz_mobile&&$("#mobile_"+a).hide()}t?(-1==qwizdata[e].i_question&&(qwizdata[e].i_question=qwizdata[e].saved_i_question),i=qwizdata[e].i_question):-1==qwizdata[e].i_question?(i=qwizdata[e].i_first_user_question,qwizdata[e].i_question=qwizdata[e].saved_i_question):i=qwizdata[e].questions[i].i_user_next_question,qwizdata[e].i_user_question=i;var s=qwizdata[e].questions[i];i==qwizdata[e].i_question&&(qwizdata[e].bck_f=!1,$(".fwd-question-qwiz"+e).css({color:"lightgray"}).removeClass("hover"));var n=s.user_question_number;$("span.question-number-qwiz"+e).html(n),i==qwizdata[e].n_questions?$("div#summary-qwiz"+e).show():($("#"+(a="qwiz"+e+"-q"+i)).show(),document_qwiz_mobile&&$("#mobile_"+a).show(),qwizdata[e].summary_b||n==qwizdata[e].n_questions&&$("div#summary-qwiz"+e).show());var _=$(".bck-question-qwiz"+e);-1==s.i_user_prev_question&&(_=_.first()),_.css({color:"gray"}).addClass("hover")}},this.display_question=function(e,t,i){var a="qwiz"+e+"-q"+t,s=$("div#"+a);debug[0]&&(console.log("[display_question] start_quiz_b:",i),console.log("[display_question] $qwizq:",s)),s.find("[id^="+a+"-a]").hide(),(d=$("div#mobile_"+a)).find("[id^=mobile_"+a+"-a]").hide();var n=s.find('input[name="qwiz_img"]');n.length&&(n.changeElements("img"),d.find('input[name="qwiz_img"]').changeElements("img"));var _=s.hasClass("qwizzled");if(_){if(qwizdata[e].$qwizzled||(qwizdata[e].$qwizzled={}),void 0===qwizdata[e].$qwizzled[a]&&(q.qwizard_b?q.init_qwizzled2(s,e,t):q.init_qwizzled(s,e,t)),qwizdata[e].n_labels_correct=0,qwizdata[e].n_label_attempts=0,-1==qwizdata[e].answered_correctly[t]){s.replaceWith(qwizdata[e].$qwizzled[a]);s=$("div#"+a);qwizdata[e].$qwizzled[a]=$("div#"+a).clone(!0);q.qwizard_b||setTimeout(function(){debug[8]&&console.log("[display_question > delay_init_drag_and_drop] i_qwiz:",e,", i_question:",t),q.init_drag_and_drop(s[0])},100);setTimeout(function(){place_labels(e,t,a)},200)}var r=0,o={};s.find("span.qwizzled_target").not(".decoy").each(function(){var e=$(this).attr("class"),t=e.match(/qtarget_sib-[0-9]*/);if(t){var i=t[0];o[i]=1}else if(t=e.match(/qwizzled_target-[0-9]*/)){i=t[0];o[i]=1}else r++}),r+=s.find("div.qwizzled_target").not(".decoy").length,qwizdata[e].n_label_targets=r+Object.keys(o).length,display_qwizzled_progress(e)}if(i&&qqc.is_mobile())q.go_mobile(e);else if(document_qwiz_mobile){var d;(d=$("#mobile_qwiz"+e+"-q"+t)).length?d.show():s.show(),window.scrollTo(0,1)}else if(debug[0]&&console.log("[display_question] $qwizq:",s),s.css("display","block"),q.qwizard_b){var c=!1;if(qwizdata[e].use_dataset_question_ids[t]){var l=s.find(".qwiz_editable");l.length&&(l.removeClass("qwiz_editable"),c=!0)}else if(0==s.find("div[contenteditable]").length){var w=s.find("div.hangman_image").length;qwizard.init_tinymce("div#"+a+" .qwiz_editable",!1,w),c=!0}if(c){var u=t;debug[0]&&console.log("[display_question] reset_i_question:",u);setTimeout(function(){if(qwizard.reset_show_me_button_text(u),void 0!==qwizdata[e].parts_htm[u])for(var t=qwizdata[e].parts_htm[u],i=t.length,a=1;a<=i;a++){var n=t[a];$("#qwiz"+e+"-q"+u+" div.qwiz-part"+a).html(n),debug[12]&&console.log("part_htm:",n)}q.init_textentry_autocomplete(s)},300)}}if(!document_qwiz_mobile&&!document_qwiz_force_mobile_f){var z="#qwiz"+e;q.preview&&(z+="-q"+t+".qwizq_preview");var h=$(z);if(_){var m=10+s.find("table.qwizzled_table").outerWidth();if(debug[0]&&console.log("[display_question] table_width:",m,", initial_width:",qwizdata[e].initial_width),m>qwizdata[e].initial_width&&(h.css({width:m+"px","max-width":"none"}),qwizdata[e].width_reset=!0),q.qwizard_b)s.find(".qwizzled_highlight_label").addClass("no_move")}else{var p=s.find("img");if(p.length){var g=10+p.outerWidth();debug[0]&&console.log("[display_question] img_width:",g,", initial_width:",qwizdata[e].initial_width),g>qwizdata[e].initial_width&&(h.css({width:g+"px","max-width":"none"}),qwizdata[e].width_reset=!0)}}var b=h.outerWidth(),v=h.parents("div");if(v.length){var f=v.outerWidth();if(f>0&&b>f){var y=f/b,x=Math.round(50*(1-y));h.css({transform:"translate(-"+x+"%, -"+x+"%) scale("+y.toFixed(3)+")"}),qwizdata[e].width_reset=!0,h[0].qscale_fac=y}}}if(!_)if(qwizdata[e].textentry&&qwizdata[e].textentry[t]){var k=$("#textentry-qwiz"+e+"-q"+t);if(qwizdata[e].textentry[t].textentry_suggest_b){if(!qwizdata[e].textentry[t].single_char_b){if(qwizdata[e].terms)qwizdata[e].textentry_terms_metaphones||(qwizdata[e].textentry_terms_metaphones=qqc.process_textentry_terms(qwizdata[e].terms));else if(!default_textentry_terms_metaphones){var A=qqc.get_qwiz_param("url","./"),C="";"body"==content&&"./"==A?"undefined"!=typeof document_qwiz_terms&&(C=document_qwiz_terms):C=qqc.get_textentry_terms(A+"terms.txt",qwizdata),default_textentry_terms_metaphones=qqc.process_textentry_terms(C)}var j;if(qwizdata[e].add_terms&&(qwizdata[e].add_textentry_terms_metaphones||(qwizdata[e].add_textentry_terms_metaphones=qqc.process_textentry_terms(qwizdata[e].add_terms))),qwizdata[e].check_answer_disabled_b=!0,qwizdata[e].textentry_n_hints=0,textentry_answers[e]=qwizdata[e].textentry[t].answers,textentry_answer_metaphones[e]=textentry_answers[e].map(function(e){return e=e.replace(/\s*(\S+)\s.*/,"$1"),qqc.metaphone(e)}),qwizdata[e].textentry[t].use_terms_b)j=qwizdata[e].textentry[t].textentry_plural_b?"plural":"singular",qwizdata[e].terms?current_question_textentry_terms_metaphones[e]=qwizdata[e].textentry_terms_metaphones[j]:current_question_textentry_terms_metaphones[e]=default_textentry_terms_metaphones[j],qwizdata[e].add_terms&&(current_question_textentry_terms_metaphones[e]=current_question_textentry_terms_metaphones[e].concat(qwizdata[e].add_textentry_terms_metaphones[j]));else current_question_textentry_terms_metaphones[e]=[];var I=textentry_answers[e].map(function(e){return[e,qqc.metaphone(e)]});if(debug[6]&&console.log("[display_question] textentry_answers_metaphones: ",I),current_question_textentry_terms_metaphones[e]=current_question_textentry_terms_metaphones[e].concat(I),current_question_textentry_terms_metaphones[e]=qqc.sort_dedupe_terms_metaphones(current_question_textentry_terms_metaphones[e]),debug[6]){console.log("[display_question] current_question_textentry_terms_metaphones[i_qwiz].length: ",current_question_textentry_terms_metaphones[e].length),console.log("[display_question] current_question_textentry_terms_metaphones[i_qwiz].slice (0, 10): ",current_question_textentry_terms_metaphones[e].slice(0,10));var O=current_question_textentry_terms_metaphones[e].length-10;O>0&&console.log("[display_question] current_question_textentry_terms_metaphones[i_qwiz].slice ("+O+"): ",current_question_textentry_terms_metaphones[e].slice(O))}var E,S,R,W=qwizdata[e].textentry[t],L=W.textentry_minlength,B=W.first_correct_answer.length;B<L&&(L=B),k.autocomplete("instance")||q.init_textentry_autocomplete(s),k.autocomplete("option","minLength",L),L<=1?(E=T("Type a letter/number"),S=T("Type a letter")):(L=Math.max(L,3),E=(E=T("Type %s+ letters/numbers, then select")).replace("%s",L),S=(S=T("Type %s+ letters")).replace("%s",L)),k.attr("placeholder",E),$("#textentry_check_answer_div-qwiz"+e+"-q"+t+" button.textentry_check_answer").html(S),qwizdata[e].check_answer=S,W.textentry_minlength=L,(R=$("#textentry_check_answer_div-qwiz"+e+"-q"+t)).find("button.textentry_check_answer").addClass("qwiz_button_disabled"),qwizdata[e].check_answer_disabled_b=!0,R.css({display:"inline-block"}),0!=t||!q.no_intro_b[e]&&1!=qwizdata[e].n_questions?q.start_hint_timeout(e):$("div#qwiz"+e).attr("onmouseenter",qname+".start_hint_timeout ("+e+")")}}else(R=$("#textentry_check_answer_div-qwiz"+e+"-q"+t)).find("button.textentry_check_answer").removeClass("qwiz_button_disabled"),qwizdata[e].check_answer_disabled_b=!1,R.css({display:"inline-block"});k.length&&(k.val("").removeAttr("disabled"),qwizdata[e].n_correct+qwizdata[e].n_incorrect==0&&q.no_intro_b[e]||(panel_exit_mobile_just_closed_b=!0,q.preview||k.focus()))}else if(qwizdata[e].information_question_b[t])$("#next_button_text-qwiz"+e).html(T("Continue")),q.position_show_next_button(e),qwizdata[e].next_button_show_b=!0;else if(void 0!==qwizdata[e].hangman[t]){var F=qwizdata[e].hangman[t],G=F.n_hangman;F.n_hangman_done=0,F.n_hangman_correct=0;for(var Y,Q=!0,N=0;N<G;N++)if($hangman=s.find("span.qwiz_hangman.qwiz_hangman_c"+N),Y=F.hangman_final_entry[N],-1==qwizdata[e].answered_correctly[t]&&G>1&&F.hangman_incorrect_chars[N].length<=3&&0==F.hangman_n_hints[N])$hangman.find("span.hangman_current_entry").html(Y),F.n_hangman_done++,F.n_hangman_correct++;else{var Z,P=Y.replace(/>[a-z0-9]</gi,">&ensp;<");if(F.hangman_current_entry[N]=P.replace(/u>&ensp;</g,"u>\t<"),$hangman.find("span.hangman_current_entry").html(P),q.qwizard_b&&"placeholder"==F.hangman_answer[N]||($hangman.find("input").removeAttr("disabled"),$("#hangman_hint-qwiz"+e+"-q"+t+"-c"+N).removeAttr("disabled").removeClass("qwiz_button_disabled")),F.hangman_incorrect_chars[N]="",F.hangman_incorrect_chars_before_hint[N]=3,F.hangman_n_hints[N]=0,$hangman[0].done_f=!1,$hangman.find("span.hangman_status").html(""),Z=-1!=F.hangman_answer[N].search(/[a-z]/i)?T("Type letters in the box"):T("Type numbers in the box"),$hangman.find("span.hangman_type_letters").html('<span class="type_letters">'+Z+"</span>").show(),s.find("div.qwiz_hangman_msg").hide(),(qwizdata[e].user_question_number>1||!q.no_intro_b[e]||-1==qwizdata[e].answered_correctly[t])&&Q&&!q.preview){Q=!1,panel_exit_mobile_just_closed_b=!0;var D=s.find("span.qwiz_hangman.qwiz_hangman_c"+N+" input");suppress_hangman_hint_b=!0,D[0].focus()}}}else $("input[name="+a+"]").removeAttr("disabled").prop("checked",!1),$("#mobile_"+a+" li.mobile_choice").show(),s.find("button.show_the_answer").removeAttr("disabled").show(),q.qwizard_b||$(".choices-"+a).on("mouseover",function(){$(this).css({cursor:"pointer",color:"#045FB4"})}).on("mouseout",function(){$(this).css({cursor:"text",color:"black"})})},this.show_response_recorded=function(e){var t=qwizdata[e].i_question,i=qwizdata[e].questions[t],a=DateFormat.format.date((new Date).getTime(),"h:mm:ss");$("span.response_recorded_wrapper-qwiz"+e).css({display:"inline-block"});var s=$("span.response_recorded-qwiz"+e),n=$("span.response_recorded_shadow-qwiz"+e);s.addClass("response_recorded_jump").attr("title","Response to question "+i.user_question_number+" recorded "+a),n.css({display:"inline-block"});setTimeout(function(){s.removeClass("response_recorded_jump"),n.hide()},500)},this.pay_lock_settings=function(e,t,i,a){qqc.pay_lock_settings(qname,qwizdata,n_qwizzes,t,i,a,e)},this.go_mobile=function(e){non_mobile_scrollLeft=window.scrollX,non_mobile_scrollTop=window.scrollY;var t=$("#qwiz"+e);if(qwizdata[e].qwiz_style=t.attr("style"),t.removeAttr("style").removeClass("qwiz").addClass("qwiz-mobile qwizard_qwiz_deck_div"),t.after('<div id="qwiz_div_placeholder"></div>'),t.appendTo("body"),window.scrollTo(0,0),$("body").css({overflow:"hidden"}),$("#icon_qwiz"+e).hide(),qqc.is_mobile()||!document_qwiz_force_mobile_f){t.find(".qwizzled_label_head_standard").hide(),t.find(".qwizzled_label_head_mobile").show();var i=qwizdata[e].i_question;if(i<qwizdata[e].n_questions&&!qwizdata[e].login_show_b){var a="qwiz"+e+"-q"+i,s=$("#"+a),n=$("#mobile_qwiz"+e+"-q"+i);n.length?(n.show(),s.hide()):s.show()}qwizdata[e].$qwizzled&&qwizdata[e].$qwizzled[a]&&(reset_label_positions(s),t.css("width","")),$(".go-mobile-qwiz"+e).hide(),document_qwiz_force_mobile_f||($(".exit-mobile-qwiz"+e).show(),$("#mode-qwiz"+e).hide(),$("#icon-exit-mobile-qwiz"+e).show(),$("#summary-qwiz"+e).find("button.summary_exit_mobile_qwiz").show()),document_qwiz_mobile="mobile_"}},this.open_panel_exit_mobile=function(e){$("#overlay-exit-mobile-qwiz"+e).show().animate({top:"0px"},500),panel_exit_mobile_open_b=!0,$("#icon-exit-mobile-qwiz"+e).hide()},this.close_panel_exit_mobile=function(e){return $(e).animate({top:"-100px"},500,function(){$(this).hide(),$("div.icon-exit-mobile-qwiz").show()}),window.scrollTo($(window).scrollLeft(),1),panel_exit_mobile_open_b=!1,panel_exit_mobile_just_closed_b=!0,!1},this.exit_mobile=function(e){var t=$("#qwiz"+e);t.attr("style",qwizdata[e].qwiz_style).removeClass("qwiz-mobile qwizard_qwiz_deck_div").addClass("qwiz"),$("#xqwiz"+e).length&&$("#qwiz"+e).css("width",qwizdata[e].initial_width+"px"),$("#qwiz_div_placeholder").replaceWith(t),$("body").css({overflow:""}),window.scrollTo(non_mobile_scrollLeft,non_mobile_scrollTop),$("#overlay-exit-mobile-qwiz"+e).css({top:"-100px",display:"none"}),$(window).off("scroll"),t.find(".qwizzled_label_head_standard").show(),t.find(".qwizzled_label_head_mobile").hide();var i,a=qwizdata[e].i_question,s="qwiz"+e+"-q"+a,n=$("#"+s);a>=0&&a<qwizdata[e].n_questions&&!qwizdata[e].login_show_b&&($("#mobile_qwiz"+e+"-q"+a).hide(),n.show());if((i=qwizdata[e].$qwizzled&&qwizdata[e].$qwizzled[s]?n.find("table.qwizzled_table"):n.find("img")).length){var _=10+i.outerWidth();if(_>qwizdata[e].initial_width){var r="#qwiz"+e;q.preview&&(r+="-q"+a+".qwizq_preview"),$(r).css({width:_+"px","max-width":"none"}),qwizdata[e].width_reset=!0}reset_label_positions(n)}$("div.icon-exit-mobile-qwiz, div.icon-panel-exit-mobile-qwiz").hide(),$(".exit-mobile-qwiz").hide(),$("button.summary_exit_mobile_qwiz").hide(),qqc.is_mobile()&&($(".go-mobile-qwiz"+e).show(),$("#mode-qwiz"+e).show()),document_qwiz_mobile="",panel_exit_mobile_just_closed_b=!1},this.start_hint_timeout=function(e){$("div#qwiz"+e).removeAttr("onmouseenter");var t=qwizdata[e].i_question,i=$("#textentry_check_answer_div-qwiz"+e+"-q"+t);debug[0]&&console.log("[start_hint_timeout] $check_answer.length:",i.length);i.find("button.qwiz_textentry_hint").html("Hint").hide(),hint_timeout_sec>=0&&(show_hint_timeout[e]=setTimeout(function(){i.find("button.qwiz_textentry_hint").removeAttr("disabled").html("Hint").css({display:"inline-block"})},1e3*hint_timeout_sec))};var first_decode_err_f=!0;function cvt_feedback(e){var t=e.indexOf("[c]");if(-1==t)return e;var i,a,s=e.substr(0,t),n=e.substr(t+3),_=n.indexOf("[f]");-1==_&&(_=n.indexOf("[fx]"));var r="";if(-1!=_)for(i=n.substr(_+3),n=n.substr(0,_);;){-1==(_=i.indexOf("[f]"))?a=i:(a=i.substr(0,_),i=i.substr(_+3));var o,d=(o=feedback_decode(a)).c;if(d&&(r+="[f]"+d),-1==_)break}return s+("[c"+(o=feedback_decode(n)).star+"]")+o.c+r}function feedback_decode(e){var t,i=e.indexOf("[Qq]"),a="";-1!=i?(t=e.substr(0,i),a=e.substr(i+4)):t=e,debug[2]&&console.log("[feedback_decode] s_to_decode:",t);var s="",n="",_=t.split(/<[^>]+>/);if(_.length>1){for(var r=t.match(/<[^>]+>/g),o=[],d=r.length,q=!0,c=0;c<d;c++){if(""!=(l=_[c])){q&&(q=!1,/ /.test(l)&&(s="*"));try{o.push(Base64.decode(l))}catch(e){}}o.push(r[c])}try{var l=_[d];q&&/ /.test(l)&&(s="*"),o.push(Base64.decode(l))}catch(e){}n=o.join("")}else{/ /.test(t)&&(s="*");try{n=Base64.decode(t)}catch(e){}}return n+=a,debug[2]&&console.log("[feedback_decode] decoded_s:",n),{c:n,star:s}}function create_hangman_textentry_editable_divs(e,t,i,a,s,n,_){_=qqc.shortcodes_to_video_elements(_);var r=[],o=create_bg_img_style(e,t);r.push('<div id="qwiz'+e+"-q"+t+'" class="qwizq qwizard_line_height"'+o+">\n"),void 0===qwizdata[e].parts_htm[t]&&(qwizdata[e].parts_htm[t]=[]);var d=0,q=1;for(_.length;;){var c=_.substr(d),l=c.search(n);if(-1==l)break;d+=l;var w=c.substr(0,l);1==q&&(w=i+w),-1==(w=qqc.remove_unmatched_tag(w,1==q)).search(/\S/)&&(w="&nbsp;"),qwizdata[e].parts_htm[t][q]=w;var u=c.match(n);debug[9]&&console.log("[create_hangman_textentry_editable_divs] m[0]:",u[0]),d+=u[0].length,r.push('<div class="qwiz-question qwiz-question-'+s+" qwiz-parts qwiz-part"+q+' qwiz-inline qwiz_editable" data-i_part="'+q+'">\n'),r.push(w),r.push("</div>"),r.push(a[q-1]),q++}w=_.substr(d);return-1==(w=qqc.remove_unmatched_tag(w,!1,!0)).search(/\S/)&&(w="&nbsp;"),qwizdata[e].parts_htm[t][q]=w,r.push('<div class="qwiz-question qwiz-question-'+s+" qwiz-parts qwiz-part"+q+' qwiz-inline qwiz_editable" data-i_part="'+q+'">\n'),r.push(w),r.push("</div>"),r.join("")}function update_hangman_input(e,t,i,a,s,n,_,r){for(var o=!1,d=!1,c=-1,l=new RegExp("u>"+e+"</u","i");;){var w=i.substr(c+1).match(l);if(!w)break;c+=w.index+2,t=qqc.setCharAt(t,c+1,w[0][2]),d=!0}debug[9]&&console.log("[update_hangman_input] keychar:",e,", good_char_b:",d);var u=qwizdata[a].hangman[s],z=u.hangman_incorrect_chars[n];if(d){u.hangman_current_entry[n]=t;var h,m=t.replace(/\t/g,"&ensp;");if($(_).parents("span.qwiz_hangman.qwiz_hangman_c"+n).find("span.hangman_current_entry").html(m),o=-1==t.indexOf("<u>\t</u>")){var p=u.n_hangman;u.n_hangman_done++,h=u.n_hangman_done==p,$(_).attr("disabled",!0),_.parentElement.done_f=!0;var g,b=z.length<=3&&0==u.hangman_n_hints[n];if(b)u.n_hangman_correct++,p>1&&($("div#qwiz"+a+"-q"+s+" div.qwiz-feedback").hide(),$("div#qwiz"+a+"-q"+s+" div.qwiz_hangman_msg").hide()),$("#qwiz"+a+"-q"+s+"-a"+n).show(),h&&u.n_hangman_correct==p&&(q.qwizard_b||qwizdata[a].n_correct++);else p>1&&$("div#qwiz"+a+"-q"+s+" div.qwiz-feedback").hide(),g=qwizdata[a].repeat_incorrect_b?"<hr />"+T("Now you've got it, but remember your answer -- you'll see this word again soon."):"<hr />"+T("Sorry, you entered more than three incorrect letters."),$("div#qwiz"+a+"-q"+s+" div.qwiz_hangman_msg").html(g).show(),h&&u.n_hangman_correct!=p&&(q.qwizard_b||qwizdata[a].n_incorrect++);if(h){if(q.qwizard_b||(qwizdata[a].answered_correctly[s]=p==u.n_hangman_correct?1:-1),_.blur(),qwizdata[a].qrecord_id&&document_qwiz_user_logged_in_b){var v=u.hangman_answer[n],f={q_and_a_text:btoa(encodeURIComponent(qwizdata[a].q_and_a_text[s])),q_and_a_crc32:qwizdata[a].q_and_a_crc32[s],i_question:qwizdata[a].dataset_id[s],unit:qwizdata[a].unit[s],type:"hangman",response:v,correct_b:b?1:"",confirm:"js"};qqc.jjax(qname,a,qwizdata[a].qrecord_id,"record_response_v3",f)}update_topic_statistics(a,s,b),update_progress_show_next(a)}else{var y=!0;for(n=0;n<p;n++)if(u.hangman_current_entry[n]!=u.hangman_final_entry[n]){var x=$("div#qwiz"+a+"-q"+s+" span.qwiz_hangman.qwiz_hangman_c"+n);y?(x.find("input").focus(),y=!1):x.find("span.hangman_type_letters").show()}}o=!0}}else e=e.toLowerCase(),-1==z.indexOf(e)&&(z+=e),u.hangman_incorrect_chars[n]=z,debug[9]&&console.log("[hangman_keyup] hangman_incorrect_chars:",z);return o}function single_char_textentry_keyup(e){var t=e.target;if(debug[6]&&console.log("[single_char_textentry_keyup] input_el:",t),-1==t.value.search(/[a-z0-9]/i))return t.value="",!1;var i=t.id.match(/qwiz([0-9]+)/)[1];debug[6]&&console.log("[single_char_textentry_keyup] i_qwiz:",i),1==qwizdata[i].user_question_number&&($("div#icon_qwiz"+i).hide(),alert_not_logged_in(i)),q.textentry_check_answer(i,!0)}function process_feedback_item(e,t,i,a){debug[2]&&console.log("[process_feedback_item] choice_html: ",e);var s,n=qqc.parse_html_block(e,["[f]","[fx]"],["[f]","[fx]","[x]"]),_="";return"NA"!=n?(e=e.replace(n,""),debug[2]&&console.log("[process_feedback_item] feedback_item_html: ",n),s=-1!=n.indexOf("[fx]"),_=create_feedback_div_html(t,i,a,n=n.replace(/\[fx{0,1}\]/,""))):n="",debug[2]&&(console.log("[process_feedback_item] feedback_div:",_),console.log("[process_feedback_item] choice_html: ",e),console.log("[process_feedback_item] fx_b:        ",s)),{feedback_div:_,choice_html:e,feedback_item_html:n,fx_b:s}}function process_qwizzled(e,t,i,a,s){debug[0]&&console.log("[process_qwizzled] question_htm: ",i);var n="",_=s.match(/\[(<code><\/code>)*q([^\]]*)\]/m);if(_){var r=_[2];r&&(n=(n=get_attr(r=qqc.replace_smart_quotes(r),"labels")).toLowerCase(),debug[0]&&console.log("[process_qwizzled] labels_position:",n))}var o='<div id="qwiz'+e+"-q"+t+'" ';q.qwizard_b?i=qqc.shortcodes_to_video_elements(i):o+='onmouseover="'+qname+'.init_drag_and_drop (this)" ',o+='class="qwizq qwizzled"><table class="qwizzled_table"><tr class="qwizzled_table">'+i,debug[0]&&console.log("[process_qwizzled] new_htm: ",o);var d=o.indexOf('<div class="qwizzled_canvas');if(-1==d)return errmsgs.push(T('Did not find target "drop-zones" for labels.  Please check that all labels and target "drop zones" were correctly processed and saved during the edit of this page')+".  qwiz: "+(e+1)+", "+T("question")+" "+(t+1)),"";var c=qqc.find_matching_block(o.substr(d));if(!c)return errmsgs.push('Did not find end of image area.  Please check that all labels and target "drop zones" were correctly processed and saved during the edit of this page.'),"";set_qwizard_data_b&&(qw.questions_cards[t].type="labeled_diagram",qw.questions_cards[t].question_text=c,qw.questions_cards[t].labels=[],qw.questions_cards[t].feedback_corrects=[],qw.questions_cards[t].feedback_incorrects=[]);var l=o.substr(d+c.length);o=o.substr(0,d+c.length);var w="qwizzled_canvas-qwiz"+e+"-q"+t,u='<td class="qwizzled_table"><div id="'+w+'"'+c.substring(4)+"</td>";if(u=u.replace('class="','class="'+w+" "),qwizdata[e].qrecord_id)if(qqc.isInteger(qwizdata[e].dataset_id[t])){var z=qqc.remove_tags_eols(i);qwizdata[e].q_and_a_text[t]=qqc.q_and_a_hash(z),qwizdata[e].q_and_a_crc32[t]=qwiz_crc32(i),debug[0]&&(console.log("[process_qwizzled] qwizdata[i_qwiz].q_and_a_text[i_question]:",qwizdata[e].q_and_a_text[t]),console.log("[process_qwizzled] qwizdata[i_qwiz].q_and_a_crc32[i_question]:",qwizdata[e].q_and_a_crc32[t]))}else qwizdata[e].q_and_a_text[t]=qwizdata[e].dataset_id[t],qwizdata[e].q_and_a_crc32[t]="dataset";var h="";"left"==n&&(h=' style="padding-right: 5px;"');var m="";"top"!=n&&"bottom"!=n&&(m=" qwizzled_labels_left_right");var p,g='<td class="qwizzled_table qwizzled_labels'+m+'"'+h+'><div class="qwizzled_labels_border">Q-LABELS-Q<div style="clear: both;"></div>\n</div></td>';p="top"==n?g+'</tr><tr class="qwizzled_table">'+u+"</tr>":"bottom"==n?u+'</tr><tr class="qwizzled_table">'+g+"</tr>":"left"==n?g+u+"</tr>":u+g+"</tr>",debug[0]&&console.log("[process_qwizzled] table_html.substr (0, 100):",p.substr(0,100)),p+='<tr class="qwizzled_table"><td class="qwizzled_table qwizzled_feedback" colspan="2">QWIZZLED-FEEDBACK-Q</td></tr></table>',o=(o=o.replace(c,p)).replace(/\[(<code><\/code>)*q[^\]]*\]/,""),debug[0]&&(console.log("[process_qwizzled] new_htm:",o),console.log("[process_qwizzled] remaining_htm:",l)),l=l.replace(/\[(<code><\/code>)*l\]/gm,"");for(var b=[],v=0;;){var f=l.search(/<div[^>]+class=".*?qwizzled_label/m);if(-1==f)break;var y=qqc.find_matching_block(l.substr(f));debug[0]&&console.log("[process_qwizzled] label_div:",y);var x='<li><div id="label-qwiz'+e+"-q"+t+"-a"+v+'"'+y.substr(4)+"</li>";b.push(x),set_qwizard_data_b&&qw.questions_cards[t].labels.push(y),l=l.replace(y,""),v++}debug[0]&&console.log("[process_qwizzled] label_divs:",b);var k;k="top"==n||"bottom"==n?'<ul class="qwizzled_labels qwizzled_labels_inline">':'<ul class="qwizzled_labels qwizzled_labels_std">',o=o.replace("Q-LABELS-Q",'<p class="qwizzled_label_head qwizzled_label_head_standard">Move each item to its correct <span class="qwizzled_target_border">place</span></p>\n<p class="qwizzled_label_head qwizzled_label_head_mobile">Click an item, then its correct <span class="qwizzled_target_border">place</span></p>\n<p class="qwizzled_label_head qwizzled_label_head_label_clicked">Click the correct <span class="qwizzled_target_border">place</span> for the label</p>'+k+b.join("\n")+"</ul>");for(var $=l,A=[],C=["[f*]","[fx]"],j=["[f*]","[fx]","[x]",'<div class="qwizzled_question_bottom_border_title"'],I=0;;){var O,E=qqc.parse_html_block($,C,j);if("NA"==E)break;$=$.replace(E,""),O=-1!=E.search(/\[f\*\]/)?"c":"x",E=E.replace(/\[f[\*x]\]/,""),debug[2]&&console.log("[process_qwizzled] feedback_item_html: ",E),A.push(create_feedback_div_html(e,t,parseInt(I/2,10),E,O)),set_qwizard_data_b&&("c"==O?qw.questions_cards[t].feedback_corrects.push(E):qw.questions_cards[t].feedback_incorrects.push(E)),I++}debug[0]&&(console.log("[process_qwizzled] feedback_divs:",A),console.log("[process_qwizzled] feedback_html:",$));var S=b.length,R=A.length;2*S!=R&&errmsgs.push(T("Number of feedback items")+" ("+R+") "+T("does not match number of labels")+" ("+S+").  qwiz: "+(1+e)+", question "+(1+t)+" labeled diagram\n("+T("There should be two feedback items -- correct and incorrect -- for each label")+")");var W='<div class="qwiz-feedback" id="qwiz'+e+"-q"+t+'-ff"></div>\n';return A.push(W),o=o.replace("QWIZZLED-FEEDBACK-Q",A.join("")),o+="</div>\n",set_qwizard_data_b&&(qw.questions_cards[t].n_labels=S),debug[2]&&console.log("[process_qwizzled] new_htm: ",o),o}function process_header(e,t,i,a){var s=["[q]","[q ",'<div class="qwizzled_question'];if(null!=a&&s.push("[i]"),"NA"!=(header_html=qqc.parse_html_block(e.substr(0,1e3),["[h]"],s,!0))&&""!=header_html){var n=e.substr(0,200);n=qqc.trim(n);var _=qqc.opening_tag_shortcode_pos("[h]",n);n=n.substr(_,5);var r=header_html.replace(/<br[^>]*>/g,"");n!=(r=qqc.trim(r).substr(0,5))&&errmsgs.push(T("Text before header")+" [h].  qwiz: "+(t+1)),e=e.replace(header_html,""),header_html=header_html.replace(/\[h\]/gi,""),header_html=(header_html=qqc.balance_closing_tag(header_html)).replace(/<(p|h[1-6])[^>]*><\/(p|h[1-6])>/g,""),header_html=qqc.decode_image_tags(header_html)}return e}function check_qwiz_tag_pairs(e){var t="",i=e.match(/\[qwiz|\[\/qwiz\]/gm);if(i){var a=i.length,s=!1;if(a%2!=0)s=!0;else for(var n=0;n<a;n++)if(n%2==0){if("[qwiz"!=i[n]){s=!0;break}}else if("[/qwiz]"!=i[n]){s=!0;break}if(s)if(-1!=e.indexOf("more-link")||-1!=e.indexOf("search-entry-readmore")){var _=e.indexOf("[qwiz"),r=e.search(/<[pa] class="more-link/);t=-1!=r?e.substring(0,_)+e.substr(r):e}else errmsgs.push(T("Unmatched [qwiz] - [/qwiz] pairs."))}return t}function create_radio_button_html(e,t,i,a){var s="",n="",_=0;"[c*]"==a&&(n='data-q="1" ',_=1);var r="",o=' onclick="'+qname+".process_choice (event, 'qwiz"+e+"-q"+t+"-a"+i+"')\"";return q.qwizard_b&&(r=' title="Click to see feedback for this answer choice"'),s+='<input type="radio" id="radio-qwiz'+e+"-q"+t+"-a"+i+'" name="qwiz'+e+"-q"+t+'" '+n+' style="border: none;"'+o+r+" />\n",debug[1]&&console.log("[create_radio_button_html] htm: ",s),{correct:_,htm:s}}function process_choice_disable(e,t){"mobile"==e.substr(0,6)&&(e=e.substr(7),t=t.substr(7));var i=document.getElementById("radio-"+e);i&&(i.checked=!0,q.qwizard_b||q.preview||$("input[name="+t+"]").attr("disabled",!0),$(".choices-"+t).on("mouseover",function(){$(this).css({cursor:"text",color:"black"})}))}function create_got_it_or_not(e,t,i){var a="";return a+='<div id="'+e+"show_answer_got_it_or_not-qwiz"+t+"-q"+i+'" class="show_answer_got_it_or_not">\n',a+='<button class="qwiz_button" onclick="'+qname+".process_choice (event, 'qwiz"+t+"-q"+i+"-a0', false, 1)\">\n",a+=T("Need more practice"),a+="</button>\n",a+="&emsp;",a+='<button class="qwiz_button" onclick="'+qname+".process_choice (event, 'qwiz"+t+"-q"+i+"-a0', true, 1)\">\n",a+=T("Got it!"),a+="</button>\n",a+="</div>\n"}function update_topic_statistics(e,t,i){var a=qwizdata[e].question_topics[t];if(a)for(var s=0;s<a.length;s++){var n=a[s];i?qwizdata[e].topic_statistics[n].n_correct++:qwizdata[e].topic_statistics[n].n_incorrect++}}function update_progress_show_next(e){if(qwizdata[e].n_questions>1||qwizdata[e].use_dataset){q.display_progress(e);var t=qwizdata[e].n_correct;if(qwizdata[e].repeat_incorrect_b||(t+=qwizdata[e].n_incorrect),t==qwizdata[e].n_questions_for_done&&(qwizdata[e].summary_b?$("#next_button_text-qwiz"+e).html(T("View summary report")):$("#summary-qwiz"+e).show(),qwizdata[e].qrecord_id&&document_qwiz_user_logged_in_b&&(qwizdata[e].use_dataset||qwizdata[e].repeat_incorrect_b||0==qwizdata[e].n_incorrect))){setTimeout(function(){qqc.jjax(qname,e,qwizdata[e].qrecord_id,"record_response_v3",{type:"completed",confirm:"js"})},2e3)}(t<qwizdata[e].n_questions_for_done||qwizdata[e].summary_b)&&q.position_show_next_button(e),qwizdata[e].next_button_show_b=!0}1==qwizdata[e].n_questions&&$("#qwiz"+e+" div.single-question_exit").show()}function display_qwizzled_progress(e){var t=qwizdata[e].i_question+1,i=qwizdata[e].n_questions,a="";i>1&&!qwizdata[e].random_b&&(a="Q #"+t+"/"+i+"; "),a+="Correctly labeled "+qwizdata[e].n_labels_correct+" out of "+qwizdata[e].n_label_targets+" items",$("#progress-qwiz"+e).html(a).show()}function create_feedback_div_html(e,t,i,a,s){var n="";null!=s&&(n=s);var _='<div id="qwiz'+e+"-q"+t+"-a"+i+n+'" class="qwiz-feedback">\n';n||(_+='<hr style="margin: 0px;" />\n');return n?_+='<div class="'+("c"==n?"qwizzled-correct_feedback":"qwizzled-incorrect_feedback")+' qwiz_editable" data-i_choice="'+i+'">'+a+"</div>":(q.qwizard_b&&(a=qqc.shortcodes_to_video_elements(a)),_+='<span class="qwiz-feedback-span qwiz_editable" data-i_choice="'+i+'">'+(a=create_restart_button(e,a,!0))+"</span>"),_+='<div style="clear: both;"></div>\n',_+="</div>\n",debug[2]&&console.log("[create_feedback_div_html] htm: ",_),_}this.hangman_show=function(e,t){if(suppress_hangman_hint_b)return suppress_hangman_hint_b=!1,!1;var i=$(e);if(i.find("span.hangman_type_letters").hide(),clearTimeout(e.i_hint_timeout),t){e.i_hint_timeout=setTimeout(function(){i.find("button.hangman_hint, span.hangman_status").fadeOut(1e3)},750)}if(!e.done_f){i.find("button.hangman_hint").show();var a=i.find("span.hangman_status");a.html()&&a.show()}},this.hangman_hide=function(e){var t=$(e);e.i_hint_timeout=setTimeout(function(){t.find("button.hangman_hint, span.hangman_status").fadeOut(500)},100)},this.hangman_keyup=function(e,t,i,a,s,n){1!=qwizdata[a].user_question_number||!q.no_intro_b[a]&&1!=qwizdata[a].n_questions||($("div#icon_qwiz"+a).hide(),alert_not_logged_in(a));var _=e.value;e.value=i,debug[9]&&console.log("[hangman_keyup] value.charCodeAt:",_.charCodeAt(0),_.charCodeAt(1),_.charCodeAt(2),_.charCodeAt(3));var r=_.replace(/[^a-z0-9]/gi,"");if(""==r)return!1;r=r.toLowerCase(),debug[9]&&console.log("[hangman_keyup] keychars:",r);for(var o=qwizdata[a].hangman[s].hangman_current_entry[n],d=qwizdata[a].hangman[s].hangman_final_entry[n],c=r.length,l=0;l<c;l++){var w;if(w=update_hangman_input(r[l],o,d,a,s,n,e))break}if(!w&&($("div#qwiz"+a+"-q"+s+" div.qwiz-feedback").hide(),$(e).parents("div.qwizq").find("div.qwiz_hangman_msg").hide(),qwizdata[a].hangman[s].hangman_incorrect_chars[n])){var u=qwizdata[a].hangman[s].hangman_incorrect_chars_before_hint[n],z=qqc.create_hangman_incorrect_chars_display(qwizdata[a].hangman[s].hangman_incorrect_chars[n],u,!0);$(e).parents("span.qwiz_hangman.qwiz_hangman_c"+n).find("span.hangman_status").html(z).show()}return!0},this.hangman_hint=function(e,t,i){if(qwizdata[e].hangman[t].hangman_n_hints[i]++,qwizdata[e].hangman[t].hangman_n_hints[i]>qwizdata[e].hangman[t].hangman_max_hints)return!1;qwizdata[e].hangman[t].hangman_n_hints[i]==qwizdata[e].hangman[t].hangman_max_hints?$("#hangman_hint-qwiz"+e+"-q"+t+"-c"+i).attr("disabled",!0).addClass("qwiz_button_disabled"):qwizdata[e].hangman[t].hangman_incorrect_chars_before_hint[i]=qwizdata[e].hangman[t].hangman_incorrect_chars[i].length;qwizdata[e].hangman[t].hangman_answer[i];var a=qwizdata[e].hangman[t].hangman_current_entry[i],s=a.match(/<u>.<\/u>/g),n=s.indexOf("<u>\t</u>");if(debug[9]&&(console.log("[hangman_hint] matches:",s),console.log("[hangman_hint] i_pos:",n)),-1!=n){var _=qwizdata[e].hangman[t].hangman_final_entry[i],r=(s=_.match(/<u>.<\/u>/g))[n][3],o=$("div#"+("qwiz"+e+"-q"+t)).find("span.qwiz_hangman.qwiz_hangman_c"+i+" input");update_hangman_input(r,a,_,e,t,i,o[0],!0),o.focus()}},this.init_drag_and_drop=function(e){debug[0]&&console.log("[init_drag_and_drop] qwizq_elm:",e);var t=$(e);t.removeAttr("onmouseover"),t.find("td.qwizzled_labels div.qwizzled_label").each(function(){(debug[0]||debug[8])&&(console.log("[init_drag_and_drop] $ (this):",$(this)),console.log("[init_drag_and_drop] 'td.qwizzled_labels div.qwizzled_label':",$(this)[0]));var e=$(this).offset();debug[8]&&console.log("[init_drag_and_drop] label_offset:",e),$(this).data("label_x",e.left).data("label_y",e.top),$(this).draggable({containment:$(this).parents("table.qwizzled_table"),start:function(e,t){var i=$(this).parents("div.qwiz");if(i.length){var a=i[0];a.qscale_fac&&(a.qstart_left=t.position.left,t.position.top?a.qstart_top=t.position.top:a.qstart_top=.1)}q.label_dragstart($(this))},drag:function(e,t){var i=$(this).parents("div.qwiz");if(i.length){var a=i[0];if(a.qscale_fac&&a.qstart_top){var s=a.qscale_fac;t.position.left=(t.position.left-a.qstart_left)/s+a.qstart_left,t.position.top=(t.position.top-a.qstart_top)/s+a.qstart_top}}}}).addClass("qwizzled_label_unplaced")}),t.find(".qwizzled_target").droppable({accept:".qwizzled_label",hoverClass:"qwizzled_target_hover",drop:function(e,t){q.label_dropped($(this),t.draggable)},tolerance:"pointer"})},this.display_summary_and_exit=function(e){if(q.qwizard_b||$(".bck-question-qwiz"+e).css({color:"gray"}).addClass("hover"),qwizdata[e].summary_b){var t=[],i=qwizdata[e].n_questions_for_done,a=qwizdata[e].n_correct,s=qwizdata[e].n_incorrect;if(qwizdata[e].repeat_incorrect_b){var n=qwizdata[e].use_dataset&&qwizdata[e].dataset_intro_f?"set":"quiz";t.push("<p><b>"+T("Congratulations, you're done!")+"</b></p>"),0==s?t.push("<p>"+T("In this")+" "+qqc.number_to_word(i)+"-"+T("question")+" "+T(n)+", "+T("you answered every question correctly on the first try!")+"</p>"):t.push("<p>"+T("In finishing this")+" "+qqc.number_to_word(i)+"-"+T("question")+" "+T(n)+", "+T("you entered")+" "+qqc.number_to_word(s)+" "+T("incorrect")+" "+Tplural("answer","answers",s)+".</p>")}else 0==s?t.push("<p>"+T("Congratulations, you answered all questions correctly")+".</p>"):t.push("<p>"+T("Your score is")+" "+qqc.number_to_word(a)+" "+T("out of")+" "+qqc.number_to_word(i)+" "+T("questions")+".</p>");var _,r=0;if(qwizdata[e].topics&&(r=qwizdata[e].topics.length),1==r){if("Other"!=(c=qwizdata[e].topics[0]))1==i?t.push("<p>The question was about topic &ldquo;"+c+".&rdquo;</p>"):(_=2==i?T("Both"):T("All")+" "+qqc.number_to_word(i),t.push("<p>"+_+" "+Tplural("question","questions",i)+" were about topic &ldquo;"+c+".&rdquo;</p>"))}else if(r>1&&s>0){for(var o=[],d=0;d<r;d++){var c=qwizdata[e].topics[d],l=(qwizdata[e].topic_statistics[c].n_correct,qwizdata[e].topic_statistics[c].n_incorrect);if(l>0){var w="<strong>"+(c=c.replace(/_/g," "))+"</strong>: "+qqc.number_to_word(l)+" "+T("incorrect");o.push(w)}}var u=o.length,z=[];if(u>1){z.push(T("These are the topics of questions that you answered incorrectly")),z.push('<ul style="padding-left: 0;">');for(var h=0;h<u;h++)z.push("<li>"),z.push(o[h]),z.push("</li>");z.push("</ul>")}else z.push(T("The topic of the only question you answered incorrectly is<br />")),z.push(o[0]);t.push(z.join("\n"))}$("#summary_report-qwiz"+e).html(t.join("\n"))}var m=$("#summary-qwiz"+e);q.qwizard_b&&0==m.find("div[contenteditable]").length&&qwizard.init_tinymce("div#qwiz_exit-qwiz"+e+".qwiz_editable");var p=m.find('input[name="qwiz_img"]');p.length&&p.changeElements("img"),qwizdata[e].cv_index&&m.find("button.qwiz_restart").remove(),m.show(),qwizdata[e].i_question=qwizdata[e].n_questions},this.process_choice=function(e,t,i,a){e&&e.stopPropagation();a=a?1:0;var s=t.match(/(.*)-/)[1],n=t.match(/(qwiz.*?)-/)[1];i_qwiz=parseInt(n.substr(4),10);var _=t.match(/-q([0-9]+)-/)[1];debug[0]&&console.log("[process_choice] feedback_id: ",t,", qwizq_id: ",s,", i_qwiz: ",i_qwiz);var r=10;if(qwizdata[i_qwiz].record_start_b&&document_qwiz_user_logged_in_b){r=500,qwizdata[i_qwiz].record_start_b=!1;var o={qrecord_id_ok:qwizdata[i_qwiz].qrecord_id_ok,type:"start",confirm:"js"};qqc.jjax(qname,i_qwiz,qwizdata[i_qwiz].qrecord_id,"record_response_v3",o)}if(q.qwizard_b){var d=t.match(/-a([0-9]+)$/)[1],c="span.choice-qwiz"+i_qwiz+"-q"+_+"-a"+d,l=$(c+" span.qwiz-choice.qwiz_editable")[0];qw.answer_choice_focus(l)}var w,u=qwizdata[i_qwiz].qrecord_id&&qwizdata[i_qwiz].use_dataset&&!qqc.isInteger(qwizdata[i_qwiz].dataset_id[_]),z="mobile_"==t.substr(0,7)?"mobile_":"";if(z?($("#"+s+" li.mobile_choice").hide(),$("#"+s+" .qwiz-feedback").hide(),u||$("#"+t).show(),$choice=$("#choice-"+t),$choice.show(),w=""):w=$("input[name="+s+"]").attr("disabled"),"disabled"!=w){if(z&&(t=t.substr(7),s=s.substr(7)),$("#"+s+" .qwiz-feedback").hide(),process_choice_disable(t,s),u||$("#"+t).show(),document.getElementById("radio-"+t)&&(i=!!$("#radio-"+t).data("q")),1!=qwizdata[i_qwiz].user_question_number||!q.no_intro_b[i_qwiz]&&1!=qwizdata[i_qwiz].n_questions||($("div#icon_qwiz"+i_qwiz).hide(),alert_not_logged_in(i_qwiz)),u||qwizdata[i_qwiz].qrecord_id&&document_qwiz_user_logged_in_b){d=t.match(/-a([0-9]+)$/)[1];var h=$("#"+s+" .choice-"+t).html();h=h?qqc.remove_tags_eols(h):qqc.remove_tags_eols($("#"+s+" button.qwiz_button").html())+"\t"+qqc.remove_tags_eols($("#"+t).html());setTimeout(function(){var e={q_and_a_text:btoa(encodeURIComponent(qwizdata[i_qwiz].q_and_a_text[_])),q_and_a_crc32:qwizdata[i_qwiz].q_and_a_crc32[_],i_question:qwizdata[i_qwiz].dataset_id[_],unit:qwizdata[i_qwiz].unit[_],type:"multiple_choice",response:h,i_choice:d,correct_b:i?1:"",feedback_id:z+t,got_it_more_practice_f:a,confirm:"js"};u&&(e.secure_f=1),q.preview_i_qwiz_plus1&&(e.preview_no_record=1),qwizdata[i_qwiz].cv_index&&(e.cv_index=qwizdata[i_qwiz].cv_index),qqc.jjax(qname,i_qwiz,qwizdata[i_qwiz].qrecord_id,"record_response_v3",e)},r)}u||q.process_choice2(z+t,a,i,-1)}},this.process_choice2=function(e,t,i,a){var s=e.match(/-q([0-9]+)-/)[1];debug[0]&&(console.log("[process_choice2] correct_b:",i,", feedback_html:",a),console.log("[process_choice2] i_question:",s));var n="mobile"==e.substr(0,6);if(-1!=a){e.match(/(.*)-/)[1];"show_answers"!=preview_mode&&$("#"+e).html(a).show(),n&&$("#"+e.substr(7)).html(a).show()}q.qwizard_b||q.preview||(qwizdata[i_qwiz].answered_correctly[s]=i?1:-1,i?qwizdata[i_qwiz].n_correct++:qwizdata[i_qwiz].n_incorrect++,update_topic_statistics(i_qwiz,s,i)),1==t?($("#"+document_qwiz_mobile+"show_answer_got_it_or_not-qwiz"+i_qwiz+"-q"+s).hide(),$("#qwiz"+i_qwiz+"-q"+s).find("button.show_the_answer").show(),q.qwizard_b||q.display_progress(i_qwiz),q.next_question(i_qwiz)):update_progress_show_next(i_qwiz)},this.show_answer_got_it_or_not=function(e,t,i){1==qwizdata[e].user_question_number&&($("div#icon_qwiz"+e).hide(),alert_not_logged_in(e)),q.qwizard_b||(i.style.display="none"),$("#"+document_qwiz_mobile+"qwiz"+e+"-q"+t+"-a0").show(),q.preview||$("#"+document_qwiz_mobile+"show_answer_got_it_or_not-qwiz"+e+"-q"+t).show()},this.display_progress=function(e,t){var i;debug[0]&&console.log("[display_progress] qwizdata[i_qwiz].i_question:",qwizdata[e].i_question,", came_from_start_b:",t);var a=qwizdata[e].n_correct+qwizdata[e].n_incorrect,s=qwizdata[e].n_correct;if(qwizdata[e].repeat_incorrect_b||(s+=qwizdata[e].n_incorrect),q.qwizard_b)if(-1!=qwizdata[e].i_question||t){var n=qwizdata[e].i_question+1;t&&n++,i="Question "+n+" of "+qwizdata[e].n_questions}else i=T("Questions in this quiz:")+" "+qwizdata[e].n_questions;else{var _,r,o=qwizdata[e].n_questions_for_done,d=o-s;if(0==a)i=T("Questions in this quiz:")+" "+d;else document_qwiz_mobile?(_=T("Qs"),r=T("not")):(_=T("questions"),r=T("incorrect")),i=o+" "+_+", "+a+" "+Tplural("response","responses",a)+", "+qwizdata[e].n_correct+" "+T("correct")+", "+qwizdata[e].n_incorrect+" "+r+", "+d+" "+T("to go")}$("#progress-qwiz"+e).html(i).show()},this.canned_feedback=function(e){var t;if(e){var i=Math.floor(Math.random()*correct.length);t=correct[i]}else{i=Math.floor(Math.random()*incorrect.length);t=incorrect[i]}return t="<p><strong>"+t+"</strong></p>",debug[0]&&console.log("[canned_feedback] response:",t),t};var find_matching_terms=function(e,t){1==qwizdata[textentry_i_qwiz].user_question_number&&($("div#icon_qwiz"+textentry_i_qwiz).hide(),alert_not_logged_in(textentry_i_qwiz));var i=e.term.toLowerCase(),a=qqc.metaphone(i);debug[6]&&console.log("[find_matching_terms] entry_metaphone; ",a);for(var s=100,n=100,_=qwizdata[textentry_i_qwiz].i_question,r=qwizdata[textentry_i_qwiz].textentry[_].textentry_minlength,o=0;o<textentry_answer_metaphones[textentry_i_qwiz].length;o++)i[0]==textentry_answers[textentry_i_qwiz][o][0].toLowerCase()&&(s=Math.min(s,textentry_answers[textentry_i_qwiz][o].length),debug[6]&&console.log("[find_matching_terms] entry[0]:",i[0],", textentry_answers[textentry_i_qwiz][i][0]:",textentry_answers[textentry_i_qwiz][o][0])),a[0]==textentry_answer_metaphones[textentry_i_qwiz][o][0]&&(n=Math.min(n,textentry_answer_metaphones[textentry_i_qwiz][o].length),debug[6]&&console.log("[find_matching_terms] textentry_answer_metaphones[textentry_i_qwiz][i]:",textentry_answer_metaphones[textentry_i_qwiz][o],", required_metaphone_length:",n));100==s?s=r:(s-=2,s=Math.min(r,s)),100!=n&&(--n<2?n=2:n>4&&(n=4)),debug[6]&&console.log("[find_matching_terms] required_entry_length:",s,", required_metaphone_length:",n);var d=i.replace(/(.)\1{2,}/gi,"$1");if(d.length<s&&a.length<n)textentry_matches[textentry_i_qwiz]=[],lc_textentry_matches[textentry_i_qwiz]=[],find_matching_terms2(t,d);else if(debug[6]&&console.log("[find_matching_terms] request.term:",e.term,", entry_metaphone:",a,", entry_metaphone.length:",a.length),textentry_matches[textentry_i_qwiz]=$.map(current_question_textentry_terms_metaphones[textentry_i_qwiz],function(e){if(""==a?""==e[1]||0===e[0].toLowerCase().indexOf(i):0===e[1].indexOf(a)||0===e[0].toLowerCase().indexOf(i))return debug[6]&&console.log("[find_matching_terms] term_i:",e),e[0]}),debug[6]&&console.log("[find_matching_terms] textentry_matches[textentry_i_qwiz]:",textentry_matches[textentry_i_qwiz]),qwizdata[textentry_i_qwiz].textentry[_].use_dict_b){var q,c=qwizdata[textentry_i_qwiz].textentry[_].textentry_plural_b?1:0,l={action:"textentry_suggestions",entry:encodeURIComponent(i),entry_metaphone:encodeURIComponent(a),n_hints:qwizdata[textentry_i_qwiz].textentry_n_hints,terms:btoa(encodeURIComponent(JSON.stringify(textentry_matches[textentry_i_qwiz]))),plural_f:c};q=qwizcards_page_f?qqc.get_qwiz_param("server_loc","http://qwizcards.com/admin")+"/qwizard_textentry_suggestions.php":qqc.get_qwiz_param("ajaxurl",""),$.ajax({type:"POST",url:q,data:l,dataType:"json",error:function(e,t){debug[0]&&console.log("[find_matching_terms] error desc:",t)},success:function(e){textentry_matches[textentry_i_qwiz]=e,find_matching_terms2(t,d)}})}else find_matching_terms2(t,d)};function find_matching_terms2(e,t){textentry_matches[textentry_i_qwiz].length&&(lc_textentry_matches[textentry_i_qwiz]=textentry_matches[textentry_i_qwiz].map(function(e){return e.toLowerCase()}),debug[6]&&console.log("[find_matching_terms2] textentry_matches[textentry_i_qwiz]:",textentry_matches[textentry_i_qwiz])),debug[6]&&console.log("[find_matching_terms2] deduped_entry.length: ",t.length,", textentry_matches[textentry_i_qwiz].length: ",textentry_matches[textentry_i_qwiz].length,", qwizdata[textentry_i_qwiz].textentry_n_hints: ",qwizdata[textentry_i_qwiz].textentry_n_hints);var i=qwizdata[textentry_i_qwiz].i_question,a=qwizdata[textentry_i_qwiz].textentry[i].textentry_minlength;if(t.length>=a&&qwizdata[textentry_i_qwiz].textentry_n_hints<5){var s=qwizdata[textentry_i_qwiz].textentry[i].first_correct_answer.toLowerCase();void 0!==lc_textentry_matches[textentry_i_qwiz]&&-1!=lc_textentry_matches[textentry_i_qwiz].indexOf(s)||($("#textentry_check_answer_div-qwiz"+textentry_i_qwiz+"-q"+i+" button.qwiz_textentry_hint").removeAttr("disabled").removeClass("qwiz_button_disabled").css({display:"inline-block"}),q.qwizard_b&&$("#qwiz"+textentry_i_qwiz+"-q"+i+" .qwiz-feedback").hide())}e(textentry_matches[textentry_i_qwiz])}function menu_closed(e){var t=e.target.value.toLowerCase(),i=qwizdata[textentry_i_qwiz].i_question,a=qwizdata[textentry_i_qwiz].textentry_n_hints;if(t.length<a){var s=qwizdata[textentry_i_qwiz].textentry[i].first_correct_answer.substr(0,a);e.target.value=s}(qwizdata[textentry_i_qwiz].check_answer_disabled_b||(debug[6]&&console.log("[menu_closed] textentry_matches[textentry_i_qwiz]: ",textentry_matches[textentry_i_qwiz]),void 0!==lc_textentry_matches[textentry_i_qwiz]&&-1!=lc_textentry_matches[textentry_i_qwiz].indexOf(t)||($("#textentry_check_answer_div-qwiz"+textentry_i_qwiz+"-q"+i+" button.textentry_check_answer").addClass("qwiz_button_disabled").html(qwizdata[textentry_i_qwiz].check_answer),qwizdata[textentry_i_qwiz].check_answer_disabled_b=!0,q.qwizard_b&&$("#qwiz"+textentry_i_qwiz+"-q"+i+" .qwiz-feedback").hide())),show_hint_timeout[textentry_i_qwiz])&&($("#textentry-qwiz"+textentry_i_qwiz+"-q"+i).val().length>=qwizdata[textentry_i_qwiz].textentry[i].textentry_minlength&&(clearTimeout(show_hint_timeout[textentry_i_qwiz]),show_hint_timeout[textentry_i_qwiz]=0))}function menu_shown(e){if(qwizdata[textentry_i_qwiz].record_start_b&&document_qwiz_user_logged_in_b){qwizdata[textentry_i_qwiz].record_start_b=!1;var t={qrecord_id_ok:qwizdata[textentry_i_qwiz].qrecord_id_ok,type:"start",confirm:"js"};qqc.jjax(qname,textentry_i_qwiz,qwizdata[textentry_i_qwiz].qrecord_id,"record_response_v3",t)}var i=e.target.value.toLowerCase(),a=qwizdata[textentry_i_qwiz].i_question,s=qwizdata[textentry_i_qwiz].textentry[a].first_correct_answer.toLowerCase();-1!=lc_textentry_matches[textentry_i_qwiz].indexOf(s)&&$("#textentry_check_answer_div-qwiz"+textentry_i_qwiz+"-q"+a+" button.qwiz_textentry_hint").attr("disabled",!0).addClass("qwiz_button_disabled"),-1!=lc_textentry_matches[textentry_i_qwiz].indexOf(i)?($("#textentry_check_answer_div-qwiz"+textentry_i_qwiz+"-q"+a+" button.textentry_check_answer").removeClass("qwiz_button_disabled").html(T("Check answer")),qwizdata[textentry_i_qwiz].check_answer_disabled_b=!1):($("#textentry_check_answer_div-qwiz"+textentry_i_qwiz+"-q"+a+" button.textentry_check_answer").addClass("qwiz_button_disabled").html(qwizdata[textentry_i_qwiz].check_answer),qwizdata[textentry_i_qwiz].check_answer_disabled_b=!0)}function alert_not_logged_in(e){q.no_intro_b[e]&&qwizdata[e].qrecord_id&&$.cookie("qwiz_user_login")&&("undefined"!=typeof document_qwiz_user_logged_in_b&&document_qwiz_user_logged_in_b&&"undefined"!=typeof document_qwiz_username||document_qwiz_declined_login_b||document_qwiz_not_logged_in_alerted||q.qwizard_b||(alert("Note: you are not logged in. You must be logged in to receive credit."),document_qwiz_not_logged_in_alerted=!0))}function redisplay_current_question(e,t){if(t<qwizdata[e].n_questions)if(document_qwiz_mobile){var i=$("#mobile_qwiz"+e+"-q"+t);i.length?i.show():$("#qwiz"+e+"-q"+t).show()}else $("#qwiz"+e+"-q"+t).show();else $("#summary-qwiz"+e).show();$(".bbfe-qwiz"+e).css({visibility:"visible"}),$("span.question-number-qwiz"+e).css({visibility:"visible"})}function get_attr(e,t,i){var a=qqc.get_attr(e,t);return i&&!a&&(a=qqc.get_attr(e,t+"s")),a}function T(e){return qqc.T(e)}function Tplural(e,t,i){return qqc.Tplural(e,t,i)}function inarray0(e,t){for(var i=e.length,a=0;a<i;a++)if(e[a][0]==t)return!0;return!1}this.textentry_check_answer=function(e,t,i){var a=qwizdata[e].i_question,s=$("#textentry-qwiz"+e+"-q"+a);if(debug[6]&&(r=s.val(),console.log("[textentry_check_answer] $textentry.val ():",s.val())),!qwizdata[e].textentry[a].textentry_suggest_b){if(qwizdata[e].record_start_b&&document_qwiz_user_logged_in_b){qwizdata[e].record_start_b=!1;var n={qrecord_id_ok:qwizdata[e].qrecord_id_ok,type:"start",confirm:"js"};qqc.jjax(qname,e,qwizdata[e].qrecord_id,"record_response_v3",n)}if(""==(r=s.val()))return!1}if(!t&&!q.qwizard_b&&!q.preview){if(qwizdata[e].check_answer_disabled_b)return alert(Tcheck_answer_message),void $("#textentry_check_answer_div-qwiz"+e+"-q"+a+" button.qwiz_textentry_hint").removeAttr("disabled").removeClass("qwiz_button_disabled").css({display:"inline-block"});$("#textentry_check_answer_div-qwiz"+e+"-q"+a).hide()}s.blur(),q.qwizard_b||q.preview||s.attr("disabled",!0);for(var _,r=s.val().toLowerCase(),o=-1,d=!1,c=qwizdata[e].textentry[a].choices.length,l=0;l<c;l++){var w=qwizdata[e].textentry[a].choices[l];if("*"==w[0])_=l;else{var u=!1;if(q.qwizard_b&&void 0!==i&&"Enter word"==w&&l==i&&(u=!0),!u)u=-1!=w.map(function(e){return e.toLowerCase()}).indexOf(r);if(u){d=qwizdata[e].textentry[a].choices_correct[l],o=l;break}}}if(-1==o&&(o=_),"questions_active"==preview_mode&&$("#qwiz"+e+"-q"+a+" .qwiz-feedback").hide(),$("#qwiz"+e+"-q"+a+"-a"+o).show(),!q.qwizard_b){if(qwizdata[e].answered_correctly[a]=d?1:-1,d?qwizdata[e].n_correct++:qwizdata[e].n_incorrect++,qwizdata[e].qrecord_id&&document_qwiz_user_logged_in_b){n={q_and_a_text:btoa(encodeURIComponent(qwizdata[e].q_and_a_text[a])),q_and_a_crc32:qwizdata[e].q_and_a_crc32[a],i_question:qwizdata[e].dataset_id[a],unit:qwizdata[e].unit[a],type:"textentry",response:r,i_choice:-1,correct_b:d?1:"",confirm:"js"};qqc.jjax(qname,e,qwizdata[e].qrecord_id,"record_response_v3",n)}update_topic_statistics(e,a,d)}update_progress_show_next(e)},this.textentry_hint=function(e){clearTimeout(show_hint_timeout[e]),show_hint_timeout[e]=0,qwizdata[e].textentry_n_hints++;var t=qwizdata[e].i_question,i=qwizdata[e].textentry[t].first_correct_answer.substr(0,qwizdata[e].textentry_n_hints);$("#textentry-qwiz"+e+"-q"+t).val(i).focus().trigger("keydown"),$("#textentry_check_answer_div-qwiz"+e+"-q"+t+" button.qwiz_textentry_hint").attr("disabled",!0).addClass("qwiz_button_disabled").html("Another hint");var a=$("#textentry_check_answer_div-qwiz"+e+"-q"+t);hint_timeout_sec>=0&&(show_hint_timeout[e]=setTimeout(function(){a.find("button.qwiz_textentry_hint").removeAttr("disabled").removeClass("qwiz_button_disabled")},1e3*hint_timeout_sec))},this.set_textentry_i_qwiz=function(e,t){var i=t.id;if(textentry_i_qwiz=i.match(/[0-9]+/)[0],debug[6]&&console.log("[set_textentry_i_qwiz] textentry_i_qwiz: ",textentry_i_qwiz),e.stopPropagation(),q.qwizard_b){var a=i.match(/qwiz.*/)[0];$("#"+a+" .qwiz-feedback").hide()}},this.item_selected=function(){var e=qwizdata[textentry_i_qwiz].i_question;$("#textentry_check_answer_div-qwiz"+textentry_i_qwiz+"-q"+e+" button.textentry_check_answer").removeClass("qwiz_button_disabled").html(T("Check answer")),qwizdata[textentry_i_qwiz].check_answer_disabled_b=!1},this.keep_next_button_active=function(){next_button_active_b=!0,$(".next_button").show()},this.position_show_next_button=function(e){$("#next_button-qwiz"+e).show()},this.hide_menu_and_display_login=function(e,t,i,a,s,n){var _=$("div.qwiz_icon_and_menu_container.qwiz"+e+" div.qwiz_icon_trigger_and_menu");_.removeClass("qwiz-hover"),q.display_login(e,t,i,a,s,n);setTimeout(function(){_.addClass("qwiz-hover")},500)},this.display_login=function(e,t,i,a,s,n){i||(i=""),t||i||$("div.qwiz-usermenu_icon").removeClass("qwiz-icon-bounce");var _=qwizdata[e].i_question;-1==_?($(".intro-qwiz"+e).hide(),q.no_intro_b[e]||$("div#icon_qwiz"+e).hide()):_>=qwizdata[e].n_questions?$("#summary-qwiz"+e).hide():($textentry_check_answer_div=$("#textentry_check_answer_div-qwiz"+e+"-q"+_),$textentry_check_answer_div.is(":visible")?($textentry_check_answer_div.hide(),qwizdata[e].textentry_check_answer_show_b=!0):qwizdata[e].textentry_check_answer_show_b=!1,hide_current_question(e,qwizdata[e].i_user_question),$(".bbfe-qwiz"+e).css({visibility:"hidden"}),$("span.question-number-qwiz"+e).css({visibility:"hidden"})),$("#next_button-qwiz"+e).hide(),"progress_bars"==i||"leaderboard"==i?"register"==qwizdata[e].display_pay_screen?$(".intro-qwiz"+e).show():qqc.create_progress_bars(qname,qwizdata,e,i):"feedback"==i?qqc.create_provide_feedback_screen(qname,e,qwizdata[e].i_question):"use_dataset_options"==i?qqc.create_use_dataset_options(qname,qwizdata,e):"pay"==i?qqc.create_pay_screen(qname,qwizdata,e,a,n):"maker_pay"==i?qqc.create_maker_pay_screen(qname,qwizdata,e,a):"enroll"==i?qqc.create_enroll_screen(qname,e):"register"==i?qqc.create_register_taker_screen(qname,e):($("#qwiz_login-qwiz"+e).html(get_login_html(e,t,a,s)).show(),qqc.init_hide_show_password("#qwiz_password-qwiz"+e),qwizdata[e].display_pay_screen||$("#qwiz_username-qwiz"+e).focus()),qwizdata[e].login_show_b=!0},this.login=function(e,t,i){t=t?1:0,i=i?1:0,$.removeCookie("qwiz_declined_login",{path:"/"}),document_qwiz_declined_login_b=!1;var a=$("#qwiz_username-qwiz"+e),s=a.val();if(!s)return alert(T("Please enter Login name")),a.focus(),!1;if(t&&-1!=document_qwiz_username.split("; ").indexOf(s))return alert("User "+s+" is already on your team."),!1;var n=$("#qwiz_password-qwiz"+e),_=n.val();if(!_)return alert(T("Please enter Password")),n.focus(),!1;n.blur();var r,o=CryptoJS.SHA3(_).toString();t?r=document_qwiz_remember_f:(r=$("#qwiz_login-qwiz"+e+' input[type="checkbox"]').prop("checked")?1:0,document_qwiz_remember_f=r);var d={username:s,sha3_password:o,remember_f:r,add_team_member_f:t};return t&&(d.previous_username=document_qwiz_username),i&&(d.proceed_to_pay_f="1"),qqc.jjax(qname,e,qwizdata[e].qrecord_id,"login",d),!1},this.login_ok=function(e,t,i,a){var s={path:"/"};1==i&&(s.expires=1),$.cookie("qwiz_session_id",document_qwiz_session_id,s),s.expires=30,$.cookie("qwiz_user_login",1,s),document_qwiz_user_logged_in_b=!0;var n=qqc.get_qwiz_param("login_timeout_min",40);if(s.expires=n/1440,$.cookie("qwiz_current_login_lt_nmin_ago",1,s),qqc.set_user_menus_and_icons(),qwiz_&&qwiz_.any_pay_quiz_f&&qwiz_.pay_lock_settings(),qcard_&&qcard_.any_pay_deck_f&&qcard_.pay_lock_settings(),$("#qwiz_login-qwiz"+e).hide(),qwizdata[e].login_show_b=!1,q.qrecord_b)for(var _=0;_<n_qwizzes;_++)qwizdata[_].qrecord_id&&(qwizdata[_].record_start_b=!0),qwizdata[_].qrecord_id&&(qwizdata[_].qrecord_id_ok="check credit");return a&&"paid"==qwizdata[e].pay_quiz_ok&&(a=!1),a?q.display_login(e,!1,"pay"):qwizdata[e].display_pay_screen?$(".intro-qwiz"+e).show():q.login_ok_start_quiz(e),!1},this.login_ok_start_quiz=function(e){var t=qwizdata[e].i_user_question;if(-1==t)q.next_question(e);else{redisplay_current_question(e,t),qwizdata[e].record_start_b=!1;var i={qrecord_id_ok:qwizdata[e].qrecord_id_ok,type:"start",confirm:"js"};qqc.jjax(qname,e,qwizdata[e].qrecord_id,"record_response_v3",i),qwizdata[e].next_button_show_b&&q.position_show_next_button(e),qwizdata[e].textentry_check_answer_show_b&&$("#textentry_check_answer_div-qwiz"+e+"-q"+t).css({display:"inline-block"})}},this.login_not_ok=function(e){$("#qwiz_login-qwiz"+e+" p.login_error").show(),debug[0]&&console.log("[login_not_ok] $ ('#qwiz_login-qwiz"+e+" p.login_error'):",$("#qwiz_login-qwiz"+e+" p.login_error"))},this.no_login=function(e,t,i){t||i||($("#qwiz_login-qwiz"+e+' input[type="checkbox"]').prop("checked")&&($.cookie("qwiz_declined_login",1,{path:"/"}),document_qwiz_declined_login_b=!0),$("div.qwiz-usermenu_icon").removeClass("qwiz-icon-bounce")),$("#qwiz_login-qwiz"+e).hide(),qwizdata[e].login_show_b=!1;var a=qwizdata[e].i_user_question;return-1==a?i?($(".intro-qwiz"+e).show(),$("#next_button-qwiz"+e).show()):q.next_question(e,!0):(redisplay_current_question(e,a),qwizdata[e].next_button_show_b&&q.position_show_next_button(e),qwizdata[e].textentry_check_answer_show_b&&$("#textentry_check_answer_div-qwiz"+e+"-q"+a).show()),!1},this.icon_no_login=function(e,t){$("div.qwiz-usermenu_icon").removeClass("qwiz-icon-bounce"),t||$("#usermenu-qwiz"+e+' input[type="checkbox"]').prop("checked")&&($.cookie("qwiz_declined_login",1,{path:"/"}),document_qwiz_declined_login_b=!0)},this.get_qwizdata=function(e,t){return qwizdata[e][t]},this.set_qwizdata=function(i_qwiz,variable,value){if(-1==i_qwiz){var s=variable+" = "+value;eval(s)}else qwizdata[i_qwiz][variable]=value}};qwizf.call(qwiz_);